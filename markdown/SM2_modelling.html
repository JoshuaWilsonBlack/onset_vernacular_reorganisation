<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="[Anonymised]">
<meta name="dcterms.date" content="2024-08-15">

<title>SM2: Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="SM2_modelling_files/libs/clipboard/clipboard.min.js"></script>
<script src="SM2_modelling_files/libs/quarto-html/quarto.js"></script>
<script src="SM2_modelling_files/libs/quarto-html/popper.min.js"></script>
<script src="SM2_modelling_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SM2_modelling_files/libs/quarto-html/anchor.min.js"></script>
<link href="SM2_modelling_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SM2_modelling_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SM2_modelling_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SM2_modelling_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SM2_modelling_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="SM2_modelling_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="SM2_modelling_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="SM2_modelling_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">SM2: Modelling</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>[Anonymised] </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">15 August 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#libraries-and-data" id="toc-libraries-and-data" class="nav-link" data-scroll-target="#libraries-and-data"><span class="header-section-number">2</span> Libraries and data</a></li>
  <li><a href="#data-exploration-and-split" id="toc-data-exploration-and-split" class="nav-link" data-scroll-target="#data-exploration-and-split"><span class="header-section-number">3</span> Data exploration and split</a></li>
  <li><a href="#kids-smooth-models" id="toc-kids-smooth-models" class="nav-link" data-scroll-target="#kids-smooth-models"><span class="header-section-number">4</span> Kids smooth models</a>
  <ul class="collapse">
  <li><a href="#modelling-strategy" id="toc-modelling-strategy" class="nav-link" data-scroll-target="#modelling-strategy"><span class="header-section-number">4.1</span> Modelling strategy</a></li>
  <li><a href="#by-vowel" id="toc-by-vowel" class="nav-link" data-scroll-target="#by-vowel"><span class="header-section-number">4.2</span> By-vowel</a></li>
  <li><a href="#note-on-model-fit" id="toc-note-on-model-fit" class="nav-link" data-scroll-target="#note-on-model-fit"><span class="header-section-number">4.3</span> Note on model fit</a></li>
  </ul></li>
  <li><a href="#quakebox-models" id="toc-quakebox-models" class="nav-link" data-scroll-target="#quakebox-models"><span class="header-section-number">5</span> QuakeBox models</a>
  <ul class="collapse">
  <li><a href="#fit" id="toc-fit" class="nav-link" data-scroll-target="#fit"><span class="header-section-number">5.1</span> Fit</a></li>
  <li><a href="#generate-predictions-and-plot" id="toc-generate-predictions-and-plot" class="nav-link" data-scroll-target="#generate-predictions-and-plot"><span class="header-section-number">5.2</span> Generate predictions and plot</a></li>
  </ul></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots"><span class="header-section-number">6</span> Plots</a>
  <ul class="collapse">
  <li><a href="#comparison-plots" id="toc-comparison-plots" class="nav-link" data-scroll-target="#comparison-plots"><span class="header-section-number">6.1</span> Comparison plots</a></li>
  <li><a href="#frequency-plots" id="toc-frequency-plots" class="nav-link" data-scroll-target="#frequency-plots"><span class="header-section-number">6.2</span> Frequency plots</a></li>
  <li><a href="#vowel-space-plots" id="toc-vowel-space-plots" class="nav-link" data-scroll-target="#vowel-space-plots"><span class="header-section-number">6.3</span> Vowel space plots</a></li>
  </ul></li>
  <li><a href="#additional-tests" id="toc-additional-tests" class="nav-link" data-scroll-target="#additional-tests"><span class="header-section-number">7</span> Additional tests</a>
  <ul class="collapse">
  <li><a href="#posterior-predictive" id="toc-posterior-predictive" class="nav-link" data-scroll-target="#posterior-predictive"><span class="header-section-number">7.1</span> Posterior predictive</a></li>
  <li><a href="#longitudinal-test" id="toc-longitudinal-test" class="nav-link" data-scroll-target="#longitudinal-test"><span class="header-section-number">7.2</span> Longitudinal test</a></li>
  </ul></li>
  <li><a href="#non-imputed-analysis" id="toc-non-imputed-analysis" class="nav-link" data-scroll-target="#non-imputed-analysis"><span class="header-section-number">8</span> Non-imputed analysis</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="overview" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Overview</h1>
<p>This markdown sets out our modelling steps for both the preschoolers’ and QuakeBox corpora. Since the <em>onset</em> of vernacular reorganisation is what we are interested in, it is important that we fit smooth models.</p>
<p>Note that this document includes both models <em>with word frequency</em> and models <em>without word frequency</em>. We fit both, but discuss those without word frequency in the paper.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>rstan</code> package requires the C++ Toolchain to be installed and configured. This enables R to compile C++ code. For the current instructions, go to <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started" class="uri">https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started</a>. This is typically done by installing RTools (follow the link on the page).</p>
</div>
</div>
</section>
<section id="libraries-and-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Libraries and data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyverse and friends</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scico)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># File path management</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># NZILBB packages for interaction with LaBB-CAT and modifying vocalic data.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nzilbb.vowels)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nzilbb.labbcat)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries for Bayesian modelling</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GAMM libraries for QuakeBox data</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(itsadug)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Nice tables.</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># secr provides the pointsInPolygon function for plotting interaction.</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(secr)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Set ggplot theme</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">bayesplot_theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>labbcat.url <span class="ot">&lt;-</span> <span class="st">'https://labbcat.canterbury.ac.nz/kids/'</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colours for vowel plots</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># These are derived from Tol's rainbow palette, designed</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># to be maximally readable for various forms of colour</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># blindness (https://personal.sron.nl/~pault/).</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colours for vowel plots</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># These are derived from Tol's rainbow palette, designed</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># to be maximally readable for various forms of colour</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># blindness (https://personal.sron.nl/~pault/).</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>vowel_colours_11 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">DRESS =</span> <span class="st">"#777777"</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">FLEECE =</span> <span class="st">"#882E72"</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">GOOSE =</span> <span class="st">"#4EB265"</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">KIT =</span> <span class="st">"#7BAFDE"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">LOT =</span> <span class="st">"#DC050C"</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">TRAP =</span> <span class="st">"#F7F056"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">START =</span> <span class="st">"#1965B0"</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">STRUT =</span> <span class="st">"#F4A736"</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">THOUGHT =</span> <span class="st">"#72190E"</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">NURSE =</span> <span class="st">"#E8601C"</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">FOOT =</span> <span class="st">"#5289C7"</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>vowel_colours_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">DRESS =</span> <span class="st">"#777777"</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">FLEECE =</span> <span class="st">'#4477AA'</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">TRAP =</span> <span class="st">'#228833'</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">NURSE =</span> <span class="st">'#EE6677'</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">KIT =</span> <span class="st">'#CCBB44'</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vowels <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'processed_vowels.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-exploration-and-split" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data exploration and split</h1>
<p>We will divide the data four ways. To decide whether there are frequency effects we fit models with and without frequency terms using the data in which frequency appears (the model comparison approach which we use requires that the models are fit on the same data!)</p>
<p>Are there any words we can deal with in terms of missing frequency information?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable to select only NZE short front vowels.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>short_front <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DRESS"</span>, <span class="st">"KIT"</span>, <span class="st">"TRAP"</span>, <span class="st">"FLEECE"</span>, <span class="st">"NURSE"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>vowels <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(childes_count),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> short_front</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, vowel) <span class="sc">|&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           word  vowel  n
1        bridge    KIT 96
2           tui FLEECE 70
3          kids    KIT 23
4   swingbridge    KIT 22
5         mummy    KIT 18
6          kiwi FLEECE 16
7        forest    KIT 13
8         sling    KIT 13
9     delicious    KIT 12
10        windy    KIT 12
11            i FLEECE 11
12       lifted    KIT 11
13      stepped  DRESS 11
14        swing    KIT 10
15      hisself    KIT  9
16       phoebe FLEECE  8
17      helping    KIT  7
18          nan   TRAP  7
19        gived    KIT  6
20     suddenly    KIT  6
21         ding    KIT  5
22       ladder   TRAP  5
23       putted    KIT  5
24  grandmother   TRAP  4
25          kid    KIT  4
26      venture  DRESS  4
27    adventure  DRESS  3
28       family   TRAP  3
29         hims    KIT  3
30         jess  DRESS  3
31       peanut FLEECE  3
32     promised    KIT  3
33        ahead  DRESS  2
34       family    KIT  2
35    grandma's   TRAP  2
36      grandpa   TRAP  2
37      healthy    KIT  2
38        him's    KIT  2
39          pam   TRAP  2
40        shirt  NURSE  2
41    stitching    KIT  2
42  supermarket    KIT  2
43     swinging    KIT  2
44        timmy    KIT  2
45      wrapped   TRAP  2
46      yelling    KIT  2
47        adult   TRAP  1
48        ankle   TRAP  1
49       ankles   TRAP  1
50      anymore    KIT  1
51       backed   TRAP  1
52    balancing    KIT  1
53         band   TRAP  1
54       banged   TRAP  1
55    breathing FLEECE  1
56    breathing    KIT  1
57         cant   TRAP  1
58     catching    KIT  1
59     catching   TRAP  1
60     checking  DRESS  1
61     checking    KIT  1
62        chick    KIT  1
63   drawbridge    KIT  1
64      explore  DRESS  1
65     explored    KIT  1
66    exploring    KIT  1
67      feeling    KIT  1
68        ferns  NURSE  1
69      flewing    KIT  1
70         gran   TRAP  1
71      grocery    KIT  1
72       handle   TRAP  1
73    happening   TRAP  1
74      happily    KIT  1
75        heaps FLEECE  1
76      hisself FLEECE  1
77     homework  NURSE  1
78       hurted  NURSE  1
79        julia FLEECE  1
80     laughing    KIT  1
81     learning  NURSE  1
82       leaved FLEECE  1
83      library    KIT  1
84      lifting    KIT  1
85         lily    KIT  1
86        loses    KIT  1
87       losing    KIT  1
88       maggie FLEECE  1
89       maggie   TRAP  1
90    meanwhile FLEECE  1
91         miss    KIT  1
92      mummy's    KIT  1
93       nana's   TRAP  1
94       oxygen    KIT  1
95      peoples FLEECE  1
96        percy    KIT  1
97        percy  NURSE  1
98      persons  NURSE  1
99        picks    KIT  1
100    porridge    KIT  1
101      ringed    KIT  1
102     rushing    KIT  1
103      seeing    KIT  1
104      served  NURSE  1
105     settled  DRESS  1
106    shouting    KIT  1
107       snack   TRAP  1
108      snacks   TRAP  1
109      swings    KIT  1
110     thanked   TRAP  1
111         tim    KIT  1
112     tripped    KIT  1
113        tuis FLEECE  1
114    tweeting FLEECE  1
115  vegetables  DRESS  1
116     weekend  DRESS  1
117     weekend FLEECE  1
118    whispers    KIT  1
119      wiggle    KIT  1
120       winds    KIT  1
121       wings    KIT  1
122   wristband    KIT  1
123           x  DRESS  1
124         yip    KIT  1</code></pre>
</div>
</div>
<p>We will also split the data into two, one for our F1 models and the other for our F2 models. This allows us to separately filter F1 and F2 outliers with the relevant columns in the data (<code>F1_outlier</code> and <code>F2_outlier</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>vowels<span class="sc">$</span>age <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="SM2_modelling_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We only model the data between 47 months and 63 months, which covers the vast majority of our data. This removes the following participant:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>vowels <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">47</span> <span class="sc">|</span> age <span class="sc">&gt;</span> <span class="dv">63</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> short_front</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">first</span>(age),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">collect =</span> <span class="fu">first</span>(collect),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tokens =</span> <span class="fu">n</span>(),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ethnicity =</span> <span class="fu">first</span>(ethnicity),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">first</span>(gender)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  participant    age collect tokens ethnicity   gender
  &lt;chr&gt;        &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; 
1 EC0312-Child    65       1     13 NZ European M     
2 EC2008-Child    65       4      3 NZ European M     </code></pre>
</div>
</div>
<p>We also scale variables to aid model fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vowels <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(age, <span class="dv">47</span>, <span class="dv">63</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> short_front,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(F1_lob2),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(F2_lob2)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_s =</span> <span class="fu">scale</span>(age),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_childes_s =</span> <span class="fu">scale</span>(<span class="fu">log</span>(childes_count))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe for F1 models</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>F1_outlier) <span class="sc">|&gt;</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    participant, collect, age_s, gender, word, vowel, stressed, stopword, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    F1_lob2, log_childes_s, age</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">as.factor</span>(gender),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">word =</span> <span class="fu">as.factor</span>(word)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe for F2 models</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>F2_outlier) <span class="sc">|&gt;</span> </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    participant, collect, age_s, gender, word, vowel, stressed, stopword, </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    F2_lob2, log_childes_s, age</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">as.factor</span>(gender),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">word =</span> <span class="fu">as.factor</span>(word)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now plot mean vowel spaces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>vowel_summary <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    stressed</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_f1 =</span> <span class="fu">mean</span>(F1_lob2),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_f2 =</span> <span class="fu">mean</span>(F2_lob2)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>mean_plot <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> vowel</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level=</span><span class="fl">0.68</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> vowel_summary, <span class="fu">aes</span>(<span class="at">x=</span>mean_f2, <span class="at">y=</span>mean_f1)) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>mean_f2, <span class="at">y=</span>mean_f1),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">10</span> <span class="sc">/</span> .pt,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>),</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="dv">2</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vowel_summary</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> vowel_colours_5) <span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Preschool"</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"First formant (normalized)"</span>,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Second formant (normalized)"</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>mean_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="SM2_modelling_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>In order to interpret this, it is worth looking at adults from the same community on the same scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>QB1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'QB1.rds'</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>QB1 <span class="ot">&lt;-</span> QB1 <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> short_front,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>unstressed</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>QB1_summary <span class="ot">&lt;-</span> QB1 <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_f1 =</span> <span class="fu">mean</span>(F1_lob2),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_f2 =</span> <span class="fu">mean</span>(F2_lob2)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>QB1_mean_plot <span class="ot">&lt;-</span> QB1 <span class="sc">|&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> vowel</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level=</span><span class="fl">0.68</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> QB1_summary, <span class="fu">aes</span>(<span class="at">x=</span>mean_f2, <span class="at">y=</span>mean_f1)) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>mean_f2, <span class="at">y=</span>mean_f1),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">10</span> <span class="sc">/</span> .pt,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="dv">2</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> QB1_summary</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> vowel_colours_5) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Community (QuakeBox)"</span>,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"First formant (normalized)"</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Second formant (normalized)"</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>QB1_mean_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="SM2_modelling_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We now combine these into a single plot.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>combined_raw_plot <span class="ot">&lt;-</span> (mean_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  QB1_mean_plot</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'normalised_vowel_spaces.tiff'</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> combined_raw_plot,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>combined_raw_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-vs" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-vs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="SM2_modelling_files/figure-html/fig-vs-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;1: Overall vowel spaces for NZE short front vowels in preschoolers (left) and adults (right). Ellipses are at 1 standard deviation."><img src="SM2_modelling_files/figure-html/fig-vs-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-vs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Overall vowel spaces for NZE short front vowels in preschoolers (left) and adults (right). Ellipses are at 1 standard deviation.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The most obvious feature of <a href="#fig-vs" class="quarto-xref">Figure&nbsp;1</a> is that the kids have much more variability in their production in normalised space. The second thing to note is the higher and fronter position of <span class="smallcaps">dress</span> in the preschool data along with the lower and backer <span class="smallcaps">trap</span>. The position of <span class="smallcaps">nurse</span> is also quite different in the two populations.</p>
</section>
<section id="kids-smooth-models" class="level1 page-columns page-full" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Kids smooth models</h1>
<section id="modelling-strategy" class="level2 page-columns page-full" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="modelling-strategy"><span class="header-section-number">4.1</span> Modelling strategy</h2>
<p>We will be fitting Bayesian GAMMs. The rationale for this is discussed in the paper. Our primary motivation is the increased control over model convergence which Bayesian methods allow. This comes, in part, from the capacity to set informative priors and to specify the underlying probabilistic model we assume.</p>
<p>First, consider our interest in word frequency and whether this is implicated in any change over time. Our measure of word frequency is imperfect and we do not have it for all words in our dataset. In order to deal with this we fit a maximal model with frequency <em>and</em> a model without frequency for each of F1 and F2 and for each of the vowels we are interested in.</p>
<p>Our model including frequency fits an interaction between age and frequency.</p>
<pre><code>F1_lob2 ~ gender + stopword + 
    t2(age_s, log_childes_s, by=gender, k = 5) +
    (1 | word/stressed) +
    (1 | participant/collect))</code></pre>
<p>Here we use a <code>t2</code> interaction term, fiting distinct smooths for male and female speakers.</p>
<p>Any effect of interest to us is not one which rapidly goes up and down in the F1 space as age increases. Rather, we want to be able to get small bends in the curve. So we reduce k to 5. This is already a complex model given the number of data points we have.</p>
<p>Our model without frequency is the following:</p>
<pre><code>F1_lob2 ~ gender + stopword + 
    s(age_s, by=gender, k = 5) +
    (1 | word/stressed) +
    (1 | participant/collect))
</code></pre>
<p>It is worth considering the distributions of the normalised formant readings.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>vowels <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"F1_lob2"</span>, <span class="st">"F2_lob2"</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"formant_type"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"formant_value"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(formant_type <span class="sc">==</span> <span class="st">"F1_lob2"</span> <span class="sc">&amp;</span> F1_outlier),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(formant_type <span class="sc">==</span> <span class="st">"F2_lob2"</span> <span class="sc">&amp;</span> F2_outlier)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> formant_value</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">stat=</span><span class="st">"density"</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">vars</span>(formant_type),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(vowel)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-resp-dist" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-resp-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="SM2_modelling_files/figure-html/fig-resp-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;2: Distribution of normalised formant readings for each vowel and formant."><img src="SM2_modelling_files/figure-html/fig-resp-dist-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-resp-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Distribution of normalised formant readings for each vowel and formant.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-resp-dist" class="quarto-xref">Figure&nbsp;2</a> suggests that we might want to be able to model skew in our data. The F1 distributions tend to have a strong right skew, and vice versa for F2.</p>
<p>We can model this by using a skew normal distribution for our response variable.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>skew_normal_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>skew_normal_test <span class="ot">&lt;-</span> skew_normal_test <span class="sc">|&gt;</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">map</span>(alpha, <span class="sc">~</span> <span class="fu">rskew_normal</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .x))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>skew_normal_test <span class="sc">|&gt;</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> data</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">bins=</span><span class="dv">30</span>, <span class="at">stat=</span><span class="st">"density"</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vars</span>(alpha)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-skew-test" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-skew-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="SM2_modelling_files/figure-html/fig-skew-test-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;3: Skew normal distributions centred one 0, with variance parameter at 1, and skew parameters ranging from -12 to 12."><img src="SM2_modelling_files/figure-html/fig-skew-test-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-skew-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Skew normal distributions centred one 0, with variance parameter at 1, and skew parameters ranging from -12 to 12.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-skew-test" class="quarto-xref">Figure&nbsp;3</a> gives a sense of the range of skewness which can be captured at different levels of the skewness parameter.</p>
<p>We now fit models to each vowel. There is a lot of repetition in code. We use the tabs below to organise the models. There is a distinct tab for each vowel.</p>
</section>
<section id="by-vowel" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="by-vowel"><span class="header-section-number">4.2</span> By-vowel</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Prior predictive check</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href=""><span class="smallcaps">dress</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href=""><span class="smallcaps">kit</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href=""><span class="smallcaps">nurse</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href=""><span class="smallcaps">trap</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href=""><span class="smallcaps">fleece</span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>We begin by sampling from our prior distribution to ensure that we are producing values in the ballpark of plausible values for our data. We’ll fit this using the data for <span class="smallcaps">dress</span>. This is for coding convenience, as the model is not learning from the data. What we are doing here is ensuring that we are not unduly biasing the model towards a particular result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dress_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"DRESS"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dress_f1_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender        word    
 Length:968         Min.   :1.000   Min.   :-1.8406525   F:548   then    :480  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M:420   went    : 80  
 Mode  :character   Median :3.000   Median :-0.0876734           said    : 78  
                    Mean   :2.646   Mean   :-0.0817232           nest    : 46  
                    3rd Qu.:4.000   3rd Qu.: 0.6636033           better  : 31  
                    Max.   :4.000   Max.   : 2.1661568           remember: 31  
                                                                 (Other) :222  
   vowel      stressed        stopword          F1_lob2        
 DRESS:968   Mode :logical   Mode :logical   Min.   :-3.60242  
             FALSE:36        FALSE:371       1st Qu.:-1.20335  
             TRUE :932       TRUE :597       Median :-0.74111  
                                             Mean   :-0.56603  
                                             3rd Qu.:-0.02123  
                                             Max.   : 4.37515  
                                                               
  log_childes_s.V1        age       
 Min.   :-2.166485   Min.   :47.00  
 1st Qu.:-0.287866   1st Qu.:51.00  
 Median : 0.076925   Median :54.00  
 Mean   :-0.271979   Mean   :54.02  
 3rd Qu.: 0.076925   3rd Qu.:57.00  
 Max.   : 0.543791   Max.   :63.00  
 NA's   :28                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dress_f1_freq_prior_sn <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f1_data <span class="sc">|&gt;</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> <span class="st">"only"</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  dress_f1_freq_prior_sn, </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_freq_prior_sn.rds'</span>), </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We load the previously fit model.</p>
<p>We take 100 draws from the prior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(dress_f1_freq_prior_sn, <span class="at">ndraws =</span> <span class="dv">100</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="ot">&lt;-</span> prior_draws <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">.name_repair=</span><span class="st">'unique'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(dress_f1_data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">'...'</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"draw_index"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"draw_value"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">draw_index =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace</span>(draw_index, <span class="st">"..."</span>, <span class="st">""</span>))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We plot the values given for a series of age and frequency values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age_s,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> draw_value</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> log_childes_s,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.1</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"100 draws from the prior predictive distribution"</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="SM2_modelling_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>There are quite a few extreme outliers, but the vast majority of the density of the prior distribution is in reasonable places.</p>
<p>We now do the same for the model without word frequency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dress_f1_prior_sn <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f1_data,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> <span class="st">"only"</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  dress_f1_prior_sn, </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_prior_sn.rds'</span>), </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As above, we take 100 draws from the prior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(dress_f1_prior_sn, <span class="at">ndraws =</span> <span class="dv">100</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="ot">&lt;-</span> prior_draws <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">.name_repair=</span><span class="st">'unique'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(dress_f1_data) <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">'...'</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"draw_index"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"draw_value"</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">draw_index =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace</span>(draw_index, <span class="st">"..."</span>, <span class="st">""</span>))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We plot the values given for a series of age and frequency values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age_s,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> draw_value</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"100 draws from the prior predictive distribution (no frequency)"</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="SM2_modelling_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Again, this is fine. If anything we’re not being informative enough.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="f1" class="level4" data-number="4.2.0.1">
<h4 data-number="4.2.0.1" class="anchored" data-anchor-id="f1"><span class="header-section-number">4.2.0.1</span> F1</h4>
<p>We repeat the code to extract the <span class="smallcaps">dress</span> data so that this tab matches the tabs for the other vowels (it is repeated from the prior predictive check).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dress_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"DRESS"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dress_f1_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender        word    
 Length:968         Min.   :1.000   Min.   :-1.8406525   F:548   then    :480  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M:420   went    : 80  
 Mode  :character   Median :3.000   Median :-0.0876734           said    : 78  
                    Mean   :2.646   Mean   :-0.0817232           nest    : 46  
                    3rd Qu.:4.000   3rd Qu.: 0.6636033           better  : 31  
                    Max.   :4.000   Max.   : 2.1661568           remember: 31  
                                                                 (Other) :222  
   vowel      stressed        stopword          F1_lob2        
 DRESS:968   Mode :logical   Mode :logical   Min.   :-3.60242  
             FALSE:36        FALSE:371       1st Qu.:-1.20335  
             TRUE :932       TRUE :597       Median :-0.74111  
                                             Mean   :-0.56603  
                                             3rd Qu.:-0.02123  
                                             Max.   : 4.37515  
                                                               
  log_childes_s.V1        age       
 Min.   :-2.166485   Min.   :47.00  
 1st Qu.:-0.287866   1st Qu.:51.00  
 Median : 0.076925   Median :54.00  
 Mean   :-0.271979   Mean   :54.02  
 3rd Qu.: 0.076925   3rd Qu.:57.00  
 Max.   : 0.543791   Max.   :63.00  
 NA's   :28                         </code></pre>
</div>
</div>
<p>Unsurprisingly, the majority of the words here are stop words. In fact, 480 tokens of 940 are the word ‘then’.</p>
<p>We first fit the model with word frequency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dress_f1_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f1_data <span class="sc">|&gt;</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  dress_f1_freq, </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_freq_sn.rds'</span>), </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dress_f1_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Look at the model summary to ensure that there are no problems with the fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dress_f1_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: dress_f1_data (Number of observations: 940) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.53      0.43     0.02     1.62 1.00
sds(t2age_slog_childes_sgenderF_2)     0.61      0.48     0.02     1.78 1.00
sds(t2age_slog_childes_sgenderF_3)     0.66      0.51     0.03     1.89 1.00
sds(t2age_slog_childes_sgenderM_1)     0.62      0.47     0.03     1.77 1.00
sds(t2age_slog_childes_sgenderM_2)     0.67      0.52     0.03     1.94 1.00
sds(t2age_slog_childes_sgenderM_3)     0.70      0.54     0.03     2.01 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     5142     3572
sds(t2age_slog_childes_sgenderF_2)     6153     3965
sds(t2age_slog_childes_sgenderF_3)     6097     4422
sds(t2age_slog_childes_sgenderM_1)     5640     4126
sds(t2age_slog_childes_sgenderM_2)     5395     3600
sds(t2age_slog_childes_sgenderM_3)     5625     3664

Multilevel Hyperparameters:
~participant (Number of levels: 113) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.34      0.06     0.23     0.45 1.00     1540     1666

~participant:collect (Number of levels: 180) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.16      0.08     0.01     0.32 1.00      746     1567

~word (Number of levels: 46) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.12     0.02     0.50 1.00     1177     1713

~word:stressed (Number of levels: 57) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.11     0.01     0.39 1.00     1302     3128

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                         -0.46      0.14    -0.73    -0.16 1.00
genderM                           -0.07      0.11    -0.28     0.15 1.00
stopwordTRUE                      -0.04      0.23    -0.54     0.39 1.00
t2age_slog_childes_s:genderF_1     0.03      0.07    -0.12     0.16 1.00
t2age_slog_childes_s:genderF_2    -0.16      0.07    -0.29    -0.03 1.00
t2age_slog_childes_s:genderF_3     0.03      0.06    -0.09     0.15 1.00
t2age_slog_childes_s:genderM_1     0.03      0.07    -0.12     0.16 1.00
t2age_slog_childes_s:genderM_2    -0.10      0.08    -0.26     0.06 1.00
t2age_slog_childes_s:genderM_3     0.14      0.07     0.01     0.27 1.00
                               Bulk_ESS Tail_ESS
Intercept                          4952     5819
genderM                            5953     6094
stopwordTRUE                       3620     4010
t2age_slog_childes_s:genderF_1     5051     5448
t2age_slog_childes_s:genderF_2     7423     6787
t2age_slog_childes_s:genderF_3     8917     5959
t2age_slog_childes_s:genderM_1     4915     5793
t2age_slog_childes_s:genderM_2     8111     6241
t2age_slog_childes_s:genderM_3     9818     6245

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.82      0.02     0.78     0.87 1.00     7224     6243
alpha     1.86      0.25     1.37     2.37 1.00     9149     6143

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>We can check the fit of the model by means of posterior predictive checks. We compare the results expected given the model with the actual data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f1_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F1)"</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="SM2_modelling_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We compare by gender.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f1_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F1)"</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="SM2_modelling_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Whatever is causing the (on-the-way-to) bimodal distribution in our actual data is not being captured by the model. However, the skew is being captured reasonably well (and better than the other approaches we have tried — including a t-distribution).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f1_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F1)"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="SM2_modelling_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The model is overestimating the minimum and underestimating the maximum of the actual data. But it is in the right ballpark. doing this for many models, we will define a function which we can reuse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>interaction_preds <span class="ot">&lt;-</span> <span class="cf">function</span>(data, fit, <span class="at">stopword =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    data_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age_s"</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>age_s), <span class="fu">max</span>(data<span class="sc">$</span>age_s), <span class="fl">0.1</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"gender"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"log_childes_s"</span> <span class="ot">=</span> <span class="fu">seq</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">min</span>(data<span class="sc">$</span>log_childes_s), <span class="fu">max</span>(data<span class="sc">$</span>log_childes_s), <span class="fl">0.1</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"stopword"</span> <span class="ot">=</span> stopword</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We only want to take predictions from areas in which we</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># actually have data. We'll use the convex hull for each gender.</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    m_hull <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        gender <span class="sc">==</span> <span class="st">"M"</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">chull</span>(age_s, log_childes_s)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    f_hull <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>        gender <span class="sc">==</span> <span class="st">"F"</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">chull</span>(age_s, log_childes_s)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove data points from outside the hull. We</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># will not query the model for any of these points.</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    data_grid <span class="ot">&lt;-</span> data_grid <span class="sc">|&gt;</span> </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>          gender <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">&amp;</span> </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pointsInPolygon</span>(</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>              data_grid <span class="sc">|&gt;</span> </span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(age_s, log_childes_s),</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>              f_hull <span class="sc">|&gt;</span> </span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(age_s, log_childes_s)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">|</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>          (</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>            gender <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>              <span class="fu">pointsInPolygon</span>(</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>                data_grid <span class="sc">|&gt;</span> </span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(age_s, log_childes_s),</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>                m_hull <span class="sc">|&gt;</span> </span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(age_s, log_childes_s)</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>    plot_data <span class="ot">&lt;-</span> data_grid <span class="sc">|&gt;</span> </span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_epred_draws</span>(</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>        fit, </span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">re_formula =</span> <span class="cn">NA</span>, </span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">ndraws=</span><span class="dv">100</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">age =</span> age_s <span class="sc">*</span> <span class="fu">sd</span>(vowels<span class="sc">$</span>age) <span class="sc">+</span> <span class="fu">mean</span>(vowels<span class="sc">$</span>age)) </span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>interaction_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model_preds, data) {</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>    model_preds <span class="sc">|&gt;</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median_qi</span>(.epred, age) <span class="sc">|&gt;</span> </span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> age,</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> log_childes_s,</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> .epred,</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">width=</span><span class="dv">1</span>, <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_jitter</span>(</span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>log_childes_s), </span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">inherit.aes=</span> <span class="cn">FALSE</span>, </span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> data,</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">"buda"</span>) <span class="sc">+</span></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> <span class="fu">vars</span>(gender)</span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>dress_f1_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    dress_f1_data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>(),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    dress_f1_freq</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>dress_int <span class="ot">&lt;-</span> dress_f1_preds <span class="sc">|&gt;</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>dress_f1_data) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"DRESS F1"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'dress_freq.tiff'</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> dress_int,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>dress_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="SM2_modelling_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>At the high frequency level, both male and female speakers show an decrease in first formant for dress (i.e.&nbsp;raising in the vowel space). For male speakers (bottom panel), there appears to be an <em>increase</em> at the low frequency level, but this occurs in places in which there is almost no data coverage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dress_f1_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f1_data,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  dress_f1_fit, </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_fit_sn.rds'</span>), </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dress_f1_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the model summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dress_f1_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: dress_f1_data (Number of observations: 968) 
  Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;
         total post-warmup draws = 6000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.58      0.48     0.02     1.80 1.00     2826
sds(sage_sgenderM_1)     0.54      0.46     0.02     1.71 1.00     2930
                     Tail_ESS
sds(sage_sgenderF_1)     3593
sds(sage_sgenderM_1)     2310

Multilevel Hyperparameters:
~participant (Number of levels: 114) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.34      0.06     0.23     0.46 1.00     1325     1967

~participant:collect (Number of levels: 183) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.18      0.08     0.02     0.32 1.01      672     1527

~word (Number of levels: 56) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.19      0.10     0.01     0.39 1.01      691      799

~word:stressed (Number of levels: 67) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.14      0.09     0.01     0.33 1.01      660     2098

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           -0.45      0.10    -0.63    -0.25 1.00     4361     4680
genderM             -0.09      0.10    -0.28     0.10 1.00     3580     3801
stopwordTRUE        -0.06      0.16    -0.39     0.25 1.00     3086     3584
sage_s:genderF_1    -0.69      0.82    -2.12     1.22 1.00     3719     3830
sage_s:genderM_1    -0.17      0.83    -1.63     1.78 1.00     4629     3442

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.82      0.02     0.78     0.87 1.00     5059     4392
alpha     1.91      0.26     1.41     2.45 1.00     6475     4890

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>We apply the same steps as above regarding diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f1_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F1)"</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="SM2_modelling_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f1_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F1)"</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-35-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="SM2_modelling_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This is a similar story to the above. We will not continue to leave these comments for the other vowels unless something particularly alarming comes up.</p>
<p>Again, we define a function to plot the smooths.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>smooth_preds <span class="ot">&lt;-</span> <span class="cf">function</span>(data, fit, <span class="at">stop =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age_s"</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(vowels<span class="sc">$</span>age_s), <span class="fu">max</span>(vowels<span class="sc">$</span>age_s), <span class="fl">0.1</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"gender"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> preds <span class="sc">|&gt;</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">stopword =</span> stop,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">participant =</span> <span class="st">"bob"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">collect =</span> <span class="st">"today"</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_epred_draws</span>(</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        fit, </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">re_formula =</span> <span class="cn">NA</span>, </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>, </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">ndraws=</span><span class="dv">1000</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> age_s <span class="sc">*</span> <span class="fu">sd</span>(vowels<span class="sc">$</span>age) <span class="sc">+</span> <span class="fu">mean</span>(vowels<span class="sc">$</span>age)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.9</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>smooth_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model_preds, data) {</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract mean formant value in order to create a dummy</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># variable to help with the rug layer in the plot.</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  mean_formant <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="fu">contains</span>(<span class="st">'_lob2'</span>)) <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> model_preds <span class="sc">|&gt;</span> </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> age,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> .epred,</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">ymin =</span> .epred.lower,</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ymax =</span> .epred.upper,</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> gender</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_rug</span>(</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span>age,</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span>dummy,</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> gender</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">sides=</span><span class="st">"b"</span>, </span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data <span class="sc">|&gt;</span> </span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">dummy =</span> <span class="fu">seq</span>(</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>              mean_formant <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>              mean_formant <span class="sc">+</span> <span class="fl">0.1</span>, </span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>              <span class="at">length.out =</span> <span class="fu">nrow</span>(data)</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>          ), </span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">inherit.aes=</span><span class="cn">FALSE</span>, </span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">position=</span><span class="st">"jitter"</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_reverse</span>()</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then apply it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dress_f1_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    dress_f1_data,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    dress_f1_fit</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>dress_smooth <span class="ot">&lt;-</span> dress_f1_preds <span class="sc">|&gt;</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> dress_f1_data) <span class="sc">+</span> </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions DRESS F1 (no freq)"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>dress_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="SM2_modelling_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Here, the <span class="math inline">\(y\)</span>-axis is flipper, so that a rising line indicates a rising vowel in the vowel space. We see that, for the female children, there is a steady rise in the <span class="smallcaps">dress</span>, albeit with very wide error bars.</p>
</section>
<section id="f2" class="level4" data-number="4.2.0.2">
<h4 data-number="4.2.0.2" class="anchored" data-anchor-id="f2"><span class="header-section-number">4.2.0.2</span> F2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dress_f2_data <span class="ot">&lt;-</span> f2 <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"DRESS"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dress_f2_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender        word    
 Length:961         Min.   :1.000   Min.   :-1.8406525   F:551   then    :483  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M:410   said    : 81  
 Mode  :character   Median :3.000   Median :-0.0876734           went    : 65  
                    Mean   :2.632   Mean   :-0.0900187           nest    : 49  
                    3rd Qu.:4.000   3rd Qu.: 0.6636033           better  : 31  
                    Max.   :4.000   Max.   : 2.1661568           remember: 27  
                                                                 (Other) :225  
   vowel      stressed        stopword          F2_lob2       
 DRESS:961   Mode :logical   Mode :logical   Min.   :-1.6195  
             FALSE:36        FALSE:358       1st Qu.: 0.6703  
             TRUE :925       TRUE :603       Median : 1.2001  
                                             Mean   : 1.1257  
                                             3rd Qu.: 1.6887  
                                             Max.   : 4.7930  
                                                              
  log_childes_s.V1        age       
 Min.   :-2.166485   Min.   :47.00  
 1st Qu.:-0.472314   1st Qu.:51.00  
 Median : 0.076925   Median :54.00  
 Mean   :-0.281459   Mean   :53.99  
 3rd Qu.: 0.076925   3rd Qu.:57.00  
 Max.   : 0.543791   Max.   :63.00  
 NA's   :27                         </code></pre>
</div>
</div>
<p>There’s some very high outliers here. Let’s have a look at a histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dress_f2_data <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-39-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="SM2_modelling_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>I would have expected these to appear as outliers in the standard deviation based filter. We leave them in, in order to avoid applying a difficult manual check to every vowel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dress_f2_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f2_data <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  dress_f2_freq, </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f2_freq_sn.rds'</span>), </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>dress_f2_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f2_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f2_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F2)"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-42-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="SM2_modelling_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f2_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F2)"</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-43-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="SM2_modelling_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dress_f2_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    dress_f2_data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>(),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    dress_f2_freq</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>dress_f2_int <span class="ot">&lt;-</span> dress_f2_preds <span class="sc">|&gt;</span> </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>dress_f2_data) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"DRESS F2"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>dress_f2_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-44-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="SM2_modelling_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>There is no strong change in <span class="smallcaps">dress</span> F2 here for either of the genders in our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dress_f2_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f2_data,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  dress_f2_fit, </span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f2_fit_sn.rds'</span>), </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dress_f2_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f2_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dress_f2_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: dress_f2_data (Number of observations: 961) 
  Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;
         total post-warmup draws = 6000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.49      0.45     0.02     1.67 1.00     2696
sds(sage_sgenderM_1)     0.48      0.41     0.02     1.55 1.00     3572
                     Tail_ESS
sds(sage_sgenderF_1)     3155
sds(sage_sgenderM_1)     3120

Multilevel Hyperparameters:
~participant (Number of levels: 116) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.30      0.05     0.21     0.40 1.00     1308     1301

~participant:collect (Number of levels: 184) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.08      0.06     0.00     0.21 1.00      776     1075

~word (Number of levels: 57) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.30      0.11     0.04     0.49 1.01      613      754

~word:stressed (Number of levels: 69) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.17      0.11     0.01     0.40 1.01      542     1543

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            0.99      0.10     0.80     1.18 1.00     4737     4786
genderM              0.03      0.09    -0.14     0.20 1.00     3197     4444
stopwordTRUE         0.12      0.20    -0.27     0.51 1.00     2295     3419
sage_s:genderF_1     0.39      0.70    -0.93     2.03 1.00     3462     3342
sage_s:genderM_1    -0.02      0.72    -1.35     1.57 1.00     4629     4181

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.76      0.02     0.72     0.80 1.00     6427     4617
alpha    -1.44      0.37    -2.04    -0.68 1.00     2750     1340

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f2_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F2)"</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-48-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="SM2_modelling_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f2_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F2)"</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-49-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="SM2_modelling_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dress_f2_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (DRESS F2)"</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-50-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="SM2_modelling_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We output predictions and plot them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>dress_f2_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    dress_f2_data,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    dress_f2_fit</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>dress_f2_smooth <span class="ot">&lt;-</span> dress_f2_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> dress_f2_data) <span class="sc">+</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions DRESS F2 (no freq)"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>dress_f2_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-51-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="SM2_modelling_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Nothing much here.</p>
</section>
<section id="remove-models" class="level4" data-number="4.2.0.3">
<h4 data-number="4.2.0.3" class="anchored" data-anchor-id="remove-models"><span class="header-section-number">4.2.0.3</span> Remove models</h4>
<p>Once we are done with plotting the models for a particular vowel, we remove them from the R environment to free up space for the next models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dress_f1_fit, dress_f1_freq, dress_f2_fit, dress_f2_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="f1-1" class="level4" data-number="4.2.0.4">
<h4 data-number="4.2.0.4" class="anchored" data-anchor-id="f1-1"><span class="header-section-number">4.2.0.4</span> F1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>kit_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"KIT"</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kit_f1_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender  
 Length:1888        Min.   :1.000   Min.   :-1.8406525   F:1014  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M: 874  
 Mode  :character   Median :3.000   Median : 0.1627522           
                    Mean   :2.799   Mean   : 0.0566396           
                    3rd Qu.:4.000   3rd Qu.: 0.9140289           
                    Max.   :4.000   Max.   : 2.1661568           
                                                                 
      word      vowel       stressed        stopword          F1_lob2       
 his    : 211   KIT:1888   Mode :logical   Mode :logical   Min.   :-3.5805  
 him    : 195              FALSE:671       FALSE:1077      1st Qu.:-1.1999  
 it     : 118              TRUE :1217      TRUE :811       Median :-0.6280  
 bridge :  93                                              Mean   :-0.5460  
 the    :  91                                              3rd Qu.: 0.0709  
 baby   :  70                                              Max.   : 5.5989  
 (Other):1110                                                               
  log_childes_s.V1       age       
 Min.   :-2.16649   Min.   :47.00  
 1st Qu.:-1.13581   1st Qu.:51.00  
 Median : 0.18640   Median :55.00  
 Mean   :-0.17997   Mean   :54.58  
 3rd Qu.: 0.38698   3rd Qu.:58.00  
 Max.   : 1.35877   Max.   :63.00  
 NA's   :316                       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>kit_f1_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> kit_f1_data<span class="sc">|&gt;</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  kit_f1_freq, </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f1_freq_sn.rds'</span>), </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>kit_f1_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f1_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kit_f1_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: kit_f1_data (Number of observations: 1572) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.68      0.54     0.03     1.98 1.00
sds(t2age_slog_childes_sgenderF_2)     0.61      0.48     0.02     1.78 1.00
sds(t2age_slog_childes_sgenderF_3)     0.58      0.45     0.02     1.66 1.00
sds(t2age_slog_childes_sgenderM_1)     0.53      0.42     0.02     1.54 1.00
sds(t2age_slog_childes_sgenderM_2)     0.69      0.52     0.03     1.95 1.00
sds(t2age_slog_childes_sgenderM_3)     0.59      0.47     0.02     1.73 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     4330     4946
sds(t2age_slog_childes_sgenderF_2)     6015     5108
sds(t2age_slog_childes_sgenderF_3)     6121     5281
sds(t2age_slog_childes_sgenderM_1)     5942     4703
sds(t2age_slog_childes_sgenderM_2)     5219     4979
sds(t2age_slog_childes_sgenderM_3)     6034     3988

Multilevel Hyperparameters:
~participant (Number of levels: 123) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.12      0.07     0.01     0.25 1.00      815     2086

~participant:collect (Number of levels: 202) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.24      0.05     0.13     0.33 1.00     1131     1862

~word (Number of levels: 130) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.27      0.10     0.03     0.44 1.01      610     1213

~word:stressed (Number of levels: 143) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.18      0.10     0.01     0.38 1.01      641     2315

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                         -0.62      0.10    -0.82    -0.42 1.00
genderM                           -0.03      0.07    -0.17     0.11 1.00
stopwordTRUE                       0.10      0.17    -0.23     0.44 1.00
t2age_slog_childes_s:genderF_1    -0.10      0.07    -0.24     0.04 1.00
t2age_slog_childes_s:genderF_2     0.07      0.05    -0.03     0.18 1.00
t2age_slog_childes_s:genderF_3    -0.03      0.04    -0.12     0.05 1.00
t2age_slog_childes_s:genderM_1    -0.06      0.07    -0.21     0.08 1.00
t2age_slog_childes_s:genderM_2    -0.02      0.06    -0.14     0.10 1.00
t2age_slog_childes_s:genderM_3    -0.05      0.05    -0.15     0.05 1.00
                               Bulk_ESS Tail_ESS
Intercept                          5329     5379
genderM                            9395     6624
stopwordTRUE                       4808     5501
t2age_slog_childes_s:genderF_1     4525     5242
t2age_slog_childes_s:genderF_2     8517     6568
t2age_slog_childes_s:genderF_3    12447     6143
t2age_slog_childes_s:genderM_1     4623     5504
t2age_slog_childes_s:genderM_2     9127     5741
t2age_slog_childes_s:genderM_3    15241     6094

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.89      0.02     0.85     0.92 1.00     7913     5734
alpha     1.28      0.18     0.91     1.62 1.00    10819     5754

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Note that for this model we get the following warning :</p>
<blockquote class="blockquote">
<p>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. Running the chains for more iterations may help. See https://mc-stan.org/misc/warnings.html#bulk-ess</p>
</blockquote>
<p>This is a problem for our random effects structure, which struggles due to the very high number of groups and very relatively small amount of data. The main effects are all well sampled.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f1_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-57-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="SM2_modelling_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f1_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-58-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="SM2_modelling_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Not bad!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f1_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-59-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="SM2_modelling_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>kit_f1_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    kit_f1_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    kit_f1_freq</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>kit_f1_int <span class="ot">&lt;-</span> kit_f1_preds <span class="sc">|&gt;</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>kit_f1_data) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"KIT F1"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>kit_f1_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-60-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="SM2_modelling_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>kit_f1_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> kit_f1_data,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  kit_f1_fit, </span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f1_fit_sn.rds'</span>), </span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>kit_f1_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f1_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kit_f1_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: kit_f1_data (Number of observations: 1888) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.45      0.39     0.02     1.44 1.00     4195
sds(sage_sgenderM_1)     0.44      0.38     0.01     1.43 1.00     4146
                     Tail_ESS
sds(sage_sgenderF_1)     4718
sds(sage_sgenderM_1)     4927

Multilevel Hyperparameters:
~participant (Number of levels: 123) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.10      0.06     0.01     0.22 1.00      958     2208

~participant:collect (Number of levels: 204) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.21      0.05     0.11     0.29 1.00     1332     1682

~word (Number of levels: 194) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.35      0.10     0.08     0.50 1.01      496      558

~word:stressed (Number of levels: 218) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.19      0.11     0.01     0.42 1.02      404      858

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           -0.65      0.06    -0.77    -0.53 1.00     9729     7155
genderM             -0.04      0.06    -0.15     0.08 1.00     8693     6453
stopwordTRUE         0.22      0.14    -0.06     0.49 1.00     4687     5445
sage_s:genderF_1     0.30      0.64    -1.23     1.45 1.00     5761     5640
sage_s:genderM_1    -0.06      0.65    -1.55     1.09 1.00     5452     3841

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.92      0.02     0.89     0.95 1.00     7436     5374
alpha     1.53      0.15     1.23     1.83 1.00    11663     6503

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f1_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-64-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="SM2_modelling_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f1_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-65-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="SM2_modelling_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Whatever is causing the bimodal distribution in our actual data is not being captured by the model. However, the skew is being captured reasonably well (and better than the other approaches we have tried).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f1_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-66-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="SM2_modelling_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>kit_f1_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    kit_f1_data,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    kit_f1_fit</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>kit_f1_smooth <span class="ot">&lt;-</span> kit_f1_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> kit_f1_data) <span class="sc">+</span> </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions KIT F1 (no freq)"</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>kit_f1_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-67-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="SM2_modelling_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f2-1" class="level4" data-number="4.2.0.5">
<h4 data-number="4.2.0.5" class="anchored" data-anchor-id="f2-1"><span class="header-section-number">4.2.0.5</span> F2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>kit_f2_data <span class="ot">&lt;-</span> f2 <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"KIT"</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kit_f2_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word     
 Length:1848        Min.   :1.000   Min.   :-1.8406525   F:988   his    : 205  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M:860   him    : 198  
 Mode  :character   Median :3.000   Median : 0.1627522           it     : 120  
                    Mean   :2.789   Mean   : 0.0517681           the    :  92  
                    3rd Qu.:4.000   3rd Qu.: 0.9140289           bridge :  91  
                    Max.   :4.000   Max.   : 2.1661568           baby   :  67  
                                                                 (Other):1075  
 vowel       stressed        stopword          F2_lob2       
 KIT:1848   Mode :logical   Mode :logical   Min.   :-1.6612  
            FALSE:642       FALSE:1034      1st Qu.: 0.2189  
            TRUE :1206      TRUE :814       Median : 0.8050  
                                            Mean   : 0.7645  
                                            3rd Qu.: 1.3401  
                                            Max.   : 3.4997  
                                                             
  log_childes_s.V1       age       
 Min.   :-2.16649   Min.   :47.00  
 1st Qu.:-1.07172   1st Qu.:51.00  
 Median : 0.18640   Median :55.00  
 Mean   :-0.15885   Mean   :54.56  
 3rd Qu.: 0.38698   3rd Qu.:58.00  
 Max.   : 1.35877   Max.   :63.00  
 NA's   :309                       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>kit_f2_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> kit_f2_data<span class="sc">|&gt;</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(kit_f2_freq, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f2_freq_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>kit_f2_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f2_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kit_f2_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: kit_f2_data (Number of observations: 1539) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.46      0.38     0.02     1.42 1.00
sds(t2age_slog_childes_sgenderF_2)     0.58      0.47     0.02     1.74 1.00
sds(t2age_slog_childes_sgenderF_3)     0.52      0.42     0.02     1.54 1.00
sds(t2age_slog_childes_sgenderM_1)     0.59      0.45     0.02     1.75 1.00
sds(t2age_slog_childes_sgenderM_2)     0.86      0.54     0.05     2.05 1.00
sds(t2age_slog_childes_sgenderM_3)     0.58      0.46     0.02     1.76 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     5595     4815
sds(t2age_slog_childes_sgenderF_2)     5354     4614
sds(t2age_slog_childes_sgenderF_3)     5237     3741
sds(t2age_slog_childes_sgenderM_1)     4639     4083
sds(t2age_slog_childes_sgenderM_2)     4074     3668
sds(t2age_slog_childes_sgenderM_3)     4242     3731

Multilevel Hyperparameters:
~participant (Number of levels: 123) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.09      0.05     0.01     0.18 1.01      889     2434

~participant:collect (Number of levels: 202) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.05     0.03     0.23 1.00      890     1100

~word (Number of levels: 129) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.26      0.13     0.02     0.48 1.01      415     1271

~word:stressed (Number of levels: 143) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.33      0.11     0.07     0.51 1.01      434      776

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                          0.97      0.11     0.76     1.17 1.00
genderM                           -0.04      0.06    -0.16     0.07 1.00
stopwordTRUE                      -0.20      0.19    -0.58     0.17 1.00
t2age_slog_childes_s:genderF_1     0.09      0.07    -0.05     0.24 1.00
t2age_slog_childes_s:genderF_2     0.03      0.04    -0.05     0.11 1.00
t2age_slog_childes_s:genderF_3     0.00      0.04    -0.07     0.08 1.00
t2age_slog_childes_s:genderM_1     0.05      0.08    -0.10     0.20 1.00
t2age_slog_childes_s:genderM_2    -0.10      0.05    -0.20    -0.01 1.00
t2age_slog_childes_s:genderM_3     0.06      0.04    -0.03     0.14 1.00
                               Bulk_ESS Tail_ESS
Intercept                          3876     4930
genderM                            7489     6390
stopwordTRUE                       3688     5178
t2age_slog_childes_s:genderF_1     3560     4927
t2age_slog_childes_s:genderF_2     8172     6093
t2age_slog_childes_s:genderF_3     9405     6055
t2age_slog_childes_s:genderM_1     3676     4906
t2age_slog_childes_s:genderM_2     8374     6092
t2age_slog_childes_s:genderM_3     8739     6311

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.77      0.02     0.74     0.80 1.00     6475     4853
alpha    -1.86      0.23    -2.32    -1.41 1.00     7803     6031

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f2_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F2)"</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-72-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="SM2_modelling_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f2_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F2)"</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-73-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="SM2_modelling_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Not bad!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f2_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F2)"</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-74-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="SM2_modelling_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>kit_f2_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    kit_f2_data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>(),</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    kit_f2_freq</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>kit_f2_int <span class="ot">&lt;-</span> kit_f2_preds <span class="sc">|&gt;</span> </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>kit_f2_data) <span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"KIT F2"</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>kit_f2_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-75-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="SM2_modelling_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>kit_f2_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> kit_f2_data,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">5000</span>,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(kit_f2_fit, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f2_fit_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>kit_f2_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f2_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kit_f2_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: kit_f2_data (Number of observations: 1848) 
  Draws: 4 chains, each with iter = 5000; warmup = 2500; thin = 1;
         total post-warmup draws = 10000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.41      0.38     0.01     1.43 1.00     4283
sds(sage_sgenderM_1)     0.37      0.34     0.01     1.28 1.00     4875
                     Tail_ESS
sds(sage_sgenderF_1)     4818
sds(sage_sgenderM_1)     4680

Multilevel Hyperparameters:
~participant (Number of levels: 123) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.08      0.05     0.00     0.17 1.01      954     2083

~participant:collect (Number of levels: 204) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.17      0.04     0.08     0.24 1.00     1230     1362

~word (Number of levels: 193) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.21      0.12     0.01     0.42 1.01      342     1060

~word:stressed (Number of levels: 218) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.40      0.08     0.23     0.53 1.01      458      996

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            0.95      0.06     0.83     1.06 1.00     7086     7801
genderM             -0.01      0.05    -0.11     0.08 1.00     8636     7384
stopwordTRUE        -0.25      0.14    -0.52     0.02 1.00     3283     5171
sage_s:genderF_1    -0.02      0.55    -1.14     1.17 1.00     4583     5391
sage_s:genderM_1    -0.42      0.55    -1.46     0.83 1.00     5437     4648

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.76      0.01     0.73     0.78 1.00     8604     7689
alpha    -1.73      0.22    -2.17    -1.31 1.00     8252     7236

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f2_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-79-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="SM2_modelling_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f2_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-80-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="SM2_modelling_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Whatever is causing the bimodal distribution in our actual data is not being captured by the model. However, the skew is being captured reasonably well (and better than the other approaches we have tried).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(kit_f2_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F2)"</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-81-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="SM2_modelling_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>kit_f2_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    kit_f2_data,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    kit_f2_fit</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>kit_f2_smooth <span class="ot">&lt;-</span> kit_f2_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> kit_f2_data) <span class="sc">+</span> </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions KIT F2 (no freq)"</span>,</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>kit_f2_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-82-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="SM2_modelling_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  kit_f1_freq,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  kit_f1_fit,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  kit_f2_freq,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  kit_f2_fit</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<section id="f1-2" class="level4" data-number="4.2.0.6">
<h4 data-number="4.2.0.6" class="anchored" data-anchor-id="f1-2"><span class="header-section-number">4.2.0.6</span> F1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"NURSE"</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nurse_f1_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word    
 Length:444         Min.   :1.000   Min.   :-1.8406525   F:263   her    :179  
 Class :character   1st Qu.:1.000   1st Qu.:-1.0893758   M:181   bird   : 91  
 Mode  :character   Median :2.000   Median :-0.3380990           hurt   : 71  
                    Mean   :2.293   Mean   :-0.2715445           work   : 19  
                    3rd Qu.:3.000   3rd Qu.: 0.4131777           heard  : 17  
                    Max.   :4.000   Max.   : 2.1661568           were   : 16  
                                                                 (Other): 51  
   vowel      stressed        stopword          F1_lob2       
 NURSE:444   Mode :logical   Mode :logical   Min.   :-2.6929  
             FALSE:14        FALSE:249       1st Qu.:-0.8285  
             TRUE :430       TRUE :195       Median :-0.2087  
                                             Mean   :-0.2164  
                                             3rd Qu.: 0.3403  
                                             Max.   : 3.3295  
                                                              
  log_childes_s.V1        age       
 Min.   :-2.166485   Min.   :47.00  
 1st Qu.:-1.507372   1st Qu.:50.00  
 Median :-0.985036   Median :53.00  
 Mean   :-0.719941   Mean   :53.27  
 3rd Qu.: 0.129137   3rd Qu.:56.00  
 Max.   : 0.129137   Max.   :63.00  
 NA's   :9                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> nurse_f1_data <span class="sc">|&gt;</span> </span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>  nurse_f1_freq,</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f1_freq_sn.rds'</span>), </span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f1_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nurse_f1_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: nurse_f1_data (Number of observations: 435) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.60      0.46     0.02     1.72 1.00
sds(t2age_slog_childes_sgenderF_2)     0.68      0.52     0.03     1.93 1.00
sds(t2age_slog_childes_sgenderF_3)     0.69      0.52     0.02     1.96 1.00
sds(t2age_slog_childes_sgenderM_1)     0.70      0.57     0.02     2.12 1.00
sds(t2age_slog_childes_sgenderM_2)     0.79      0.60     0.03     2.22 1.00
sds(t2age_slog_childes_sgenderM_3)     0.84      0.59     0.04     2.18 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     6477     4289
sds(t2age_slog_childes_sgenderF_2)     6952     4686
sds(t2age_slog_childes_sgenderF_3)     5811     4430
sds(t2age_slog_childes_sgenderM_1)     5884     4711
sds(t2age_slog_childes_sgenderM_2)     6116     4346
sds(t2age_slog_childes_sgenderM_3)     4422     3445

Multilevel Hyperparameters:
~participant (Number of levels: 105) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.41      0.08     0.22     0.56 1.00      878      866

~participant:collect (Number of levels: 152) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.10     0.01     0.39 1.01      762     1082

~word (Number of levels: 20) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.18      0.13     0.01     0.48 1.00     2651     3894

~word:stressed (Number of levels: 27) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.14      0.11     0.01     0.41 1.00     2871     4091

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                         -0.11      0.21    -0.55     0.30 1.00
genderM                            0.12      0.13    -0.13     0.38 1.00
stopwordTRUE                      -0.27      0.37    -0.96     0.52 1.00
t2age_slog_childes_s:genderF_1     0.14      0.14    -0.14     0.41 1.00
t2age_slog_childes_s:genderF_2     0.05      0.11    -0.15     0.26 1.00
t2age_slog_childes_s:genderF_3    -0.07      0.08    -0.24     0.09 1.00
t2age_slog_childes_s:genderM_1     0.22      0.15    -0.08     0.51 1.00
t2age_slog_childes_s:genderM_2    -0.14      0.11    -0.36     0.09 1.00
t2age_slog_childes_s:genderM_3    -0.09      0.10    -0.29     0.10 1.00
                               Bulk_ESS Tail_ESS
Intercept                          4137     4898
genderM                            6330     5955
stopwordTRUE                       4043     4662
t2age_slog_childes_s:genderF_1     3902     4222
t2age_slog_childes_s:genderF_2     8360     6535
t2age_slog_childes_s:genderF_3     9036     6069
t2age_slog_childes_s:genderM_1     4071     4494
t2age_slog_childes_s:genderM_2     7990     6320
t2age_slog_childes_s:genderM_3     8714     6431

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.75      0.03     0.69     0.81 1.00     6789     6586
alpha     1.41      0.80    -0.52     2.86 1.00     4230     5774

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F1)"</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-88-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="SM2_modelling_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F1)"</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-89-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="SM2_modelling_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F1)"</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-90-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="SM2_modelling_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    nurse_f1_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    nurse_f1_freq</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>nurse_f1_int <span class="ot">&lt;-</span> nurse_f1_preds <span class="sc">|&gt;</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>nurse_f1_data) <span class="sc">+</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"NURSE F1"</span>,</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>nurse_f1_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-91-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="SM2_modelling_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>I wouldn’t make too many inferences from this!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> nurse_f1_data,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(nurse_f1_fit, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f1_fit_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f1_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nurse_f1_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: nurse_f1_data (Number of observations: 444) 
  Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;
         total post-warmup draws = 6000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.54      0.45     0.01     1.67 1.00     2920
sds(sage_sgenderM_1)     0.53      0.44     0.02     1.65 1.00     3688
                     Tail_ESS
sds(sage_sgenderF_1)     2262
sds(sage_sgenderM_1)     2672

Multilevel Hyperparameters:
~participant (Number of levels: 105) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.38      0.09     0.19     0.53 1.00      739      521

~participant:collect (Number of levels: 153) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.10     0.01     0.37 1.02      473      726

~word (Number of levels: 28) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.23      0.16     0.01     0.63 1.00     1242     2309

~word:stressed (Number of levels: 35) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.18      0.13     0.01     0.50 1.00     1490     2519

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           -0.22      0.14    -0.47     0.07 1.00     4649     3900
genderM              0.11      0.12    -0.12     0.34 1.00     3847     4302
stopwordTRUE         0.01      0.28    -0.60     0.57 1.00     2842     3110
sage_s:genderF_1     0.40      0.88    -1.23     2.34 1.00     3580     3536
sage_s:genderM_1    -0.48      0.88    -2.05     1.43 1.00     3635     3674

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.78      0.03     0.72     0.85 1.00     3203     4061
alpha     2.07      0.63     0.99     3.43 1.00     2978     3424

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F1)"</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-95-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="SM2_modelling_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F1)"</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-96-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="SM2_modelling_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (KIT F1)"</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-97-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="SM2_modelling_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    nurse_f1_data,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    nurse_f1_fit</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>nurse_f1_smooth <span class="ot">&lt;-</span> nurse_f1_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> nurse_f1_data) <span class="sc">+</span> </span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions NURSE F1 (no freq)"</span>,</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>nurse_f1_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-98-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="SM2_modelling_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f2-2" class="level4" data-number="4.2.0.7">
<h4 data-number="4.2.0.7" class="anchored" data-anchor-id="f2-2"><span class="header-section-number">4.2.0.7</span> F2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_data <span class="ot">&lt;-</span> f2 <span class="sc">|&gt;</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"NURSE"</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nurse_f2_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word    
 Length:447         Min.   :1.000   Min.   :-1.8406525   F:262   her    :184  
 Class :character   1st Qu.:1.000   1st Qu.:-1.0893758   M:185   bird   : 91  
 Mode  :character   Median :2.000   Median :-0.3380990           hurt   : 73  
                    Mean   :2.291   Mean   :-0.2787140           work   : 18  
                    3rd Qu.:3.000   3rd Qu.: 0.4131777           were   : 16  
                    Max.   :4.000   Max.   : 2.1661568           heard  : 15  
                                                                 (Other): 50  
   vowel      stressed        stopword          F2_lob2        
 NURSE:447   Mode :logical   Mode :logical   Min.   :-1.84005  
             FALSE:13        FALSE:247       1st Qu.:-0.59139  
             TRUE :434       TRUE :200       Median : 0.03964  
                                             Mean   :-0.04178  
                                             3rd Qu.: 0.53372  
                                             Max.   : 1.61821  
                                                               
  log_childes_s.V1        age       
 Min.   :-2.166485   Min.   :47.00  
 1st Qu.:-1.507372   1st Qu.:50.00  
 Median :-0.985036   Median :53.00  
 Mean   :-0.708771   Mean   :53.24  
 3rd Qu.: 0.129137   3rd Qu.:56.00  
 Max.   : 0.129137   Max.   :63.00  
 NA's   :8                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> nurse_f2_data<span class="sc">|&gt;</span> </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  nurse_f2_freq, </span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f2_freq_sn.rds'</span>), </span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f2_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nurse_f2_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: nurse_f2_data (Number of observations: 439) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.62      0.49     0.02     1.81 1.00
sds(t2age_slog_childes_sgenderF_2)     0.65      0.50     0.03     1.90 1.00
sds(t2age_slog_childes_sgenderF_3)     0.85      0.58     0.04     2.16 1.00
sds(t2age_slog_childes_sgenderM_1)     0.55      0.44     0.02     1.64 1.00
sds(t2age_slog_childes_sgenderM_2)     0.73      0.56     0.03     2.01 1.00
sds(t2age_slog_childes_sgenderM_3)     0.79      0.59     0.03     2.22 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     3102     2559
sds(t2age_slog_childes_sgenderF_2)     3188     2470
sds(t2age_slog_childes_sgenderF_3)     2703     2231
sds(t2age_slog_childes_sgenderM_1)     3121     2243
sds(t2age_slog_childes_sgenderM_2)     3544     2671
sds(t2age_slog_childes_sgenderM_3)     2346     2248

Multilevel Hyperparameters:
~participant (Number of levels: 104) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.32      0.07     0.18     0.45 1.00      717      875

~participant:collect (Number of levels: 152) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.23      0.08     0.06     0.39 1.01      430      697

~word (Number of levels: 20) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.13      0.09     0.01     0.35 1.00     1961     2561

~word:stressed (Number of levels: 27) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.17      0.10     0.01     0.39 1.00     1429     1883

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                          0.26      0.18    -0.12     0.61 1.00
genderM                           -0.03      0.11    -0.25     0.20 1.00
stopwordTRUE                      -0.66      0.30    -1.27    -0.04 1.00
t2age_slog_childes_s:genderF_1     0.13      0.12    -0.11     0.36 1.00
t2age_slog_childes_s:genderF_2    -0.09      0.10    -0.27     0.09 1.00
t2age_slog_childes_s:genderF_3     0.03      0.08    -0.11     0.19 1.00
t2age_slog_childes_s:genderM_1     0.10      0.13    -0.16     0.34 1.00
t2age_slog_childes_s:genderM_2    -0.14      0.10    -0.33     0.06 1.00
t2age_slog_childes_s:genderM_3    -0.06      0.08    -0.21     0.09 1.00
                               Bulk_ESS Tail_ESS
Intercept                          2567     2673
genderM                            3478     2950
stopwordTRUE                       2718     2646
t2age_slog_childes_s:genderF_1     2571     2554
t2age_slog_childes_s:genderF_2     3290     2835
t2age_slog_childes_s:genderF_3     4251     3042
t2age_slog_childes_s:genderM_1     2622     2740
t2age_slog_childes_s:genderM_2     3627     3297
t2age_slog_childes_s:genderM_3     6118     3015

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.58      0.02     0.54     0.63 1.00     2622     2743
alpha    -0.31      0.89    -1.87     1.40 1.00     4030     3396

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f2_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F2)"</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-103-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="SM2_modelling_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f2_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F2)"</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-104-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="SM2_modelling_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The <code>M</code> data distribution is pretty strange!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f2_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F2)"</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-105-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="SM2_modelling_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    nurse_f2_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    nurse_f2_freq</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>nurse_f2_int <span class="ot">&lt;-</span> nurse_f2_preds <span class="sc">|&gt;</span> </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>nurse_f2_data) <span class="sc">+</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"NURSE F2"</span>,</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>nurse_f2_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-106-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="SM2_modelling_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> nurse_f2_data,</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(nurse_f2_fit, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f2_fit_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'nurse_f2_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nurse_f2_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: nurse_f2_data (Number of observations: 447) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.51      0.42     0.02     1.60 1.00     5532
sds(sage_sgenderM_1)     0.73      0.53     0.03     2.01 1.00     3587
                     Tail_ESS
sds(sage_sgenderF_1)     5147
sds(sage_sgenderM_1)     3706

Multilevel Hyperparameters:
~participant (Number of levels: 105) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.32      0.07     0.16     0.43 1.00     1105      805

~participant:collect (Number of levels: 155) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.21      0.09     0.03     0.39 1.01      752     1246

~word (Number of levels: 27) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.12      0.09     0.00     0.32 1.00     3531     4649

~word:stressed (Number of levels: 34) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.18      0.09     0.02     0.36 1.00     2885     3202

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            0.13      0.10    -0.08     0.33 1.00     8896     6555
genderM             -0.02      0.10    -0.22     0.19 1.00     7101     6798
stopwordTRUE        -0.46      0.21    -0.89    -0.08 1.00     6554     5536
sage_s:genderF_1    -0.39      0.79    -2.01     1.25 1.00     7147     5377
sage_s:genderM_1    -1.16      1.03    -3.49     0.53 1.00     3350     5755

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.58      0.02     0.54     0.63 1.00     5570     6324
alpha    -0.15      0.87    -1.70     1.46 1.00     7389     6314

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f2_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F2)"</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-110-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52"><img src="SM2_modelling_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f1_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F2)"</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-111-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53"><img src="SM2_modelling_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(nurse_f2_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (NURSE F2)"</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-112-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54"><img src="SM2_modelling_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>nurse_f2_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    nurse_f2_data,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    nurse_f2_fit</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>nurse_f2_smooth <span class="ot">&lt;-</span> nurse_f2_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> nurse_f2_data) <span class="sc">+</span> </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions NURSE F1 (no freq)"</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>nurse_f2_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-113-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55"><img src="SM2_modelling_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  nurse_f1_freq,</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  nurse_f1_fit,</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  nurse_f2_freq,</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  nurse_f2_fit</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<section id="f1-3" class="level4" data-number="4.2.0.8">
<h4 data-number="4.2.0.8" class="anchored" data-anchor-id="f1-3"><span class="header-section-number">4.2.0.8</span> F1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>trap_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"TRAP"</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trap_f1_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word    
 Length:987         Min.   :1.000   Min.   :-1.8406525   F:570   and    :408  
 Class :character   1st Qu.:2.000   1st Qu.:-0.5885246   M:417   nana   :148  
 Mode  :character   Median :3.000   Median : 0.1627522           that   : 96  
                    Mean   :2.894   Mean   : 0.0912020           back   : 62  
                    3rd Qu.:4.000   3rd Qu.: 0.9140289           grandma: 28  
                    Max.   :4.000   Max.   : 2.1661568           that's : 24  
                                                                 (Other):221  
  vowel      stressed        stopword          F1_lob2       
 TRAP:987   Mode :logical   Mode :logical   Min.   :-4.6431  
            FALSE:42        FALSE:376       1st Qu.:-0.1957  
            TRUE :945       TRUE :611       Median : 0.7445  
                                            Mean   : 0.8519  
                                            3rd Qu.: 1.7505  
                                            Max.   : 7.5305  
                                                             
  log_childes_s.V1       age       
 Min.   :-2.16649   Min.   :47.00  
 1st Qu.:-1.10929   1st Qu.:52.00  
 Median : 1.17969   Median :55.00  
 Mean   : 0.18614   Mean   :54.71  
 3rd Qu.: 1.17969   3rd Qu.:58.00  
 Max.   : 1.18135   Max.   :63.00  
 NA's   :41                        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>trap_f1_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trap_f1_data <span class="sc">|&gt;</span> </span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(trap_f1_freq, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f1_freq_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>trap_f1_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f1_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trap_f1_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: trap_f1_data (Number of observations: 946) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.70      0.53     0.03     2.01 1.00
sds(t2age_slog_childes_sgenderF_2)     0.85      0.60     0.04     2.25 1.00
sds(t2age_slog_childes_sgenderF_3)     0.82      0.56     0.04     2.08 1.00
sds(t2age_slog_childes_sgenderM_1)     0.78      0.57     0.04     2.18 1.00
sds(t2age_slog_childes_sgenderM_2)     0.73      0.55     0.03     2.03 1.00
sds(t2age_slog_childes_sgenderM_3)     0.71      0.54     0.02     1.98 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     3084     2303
sds(t2age_slog_childes_sgenderF_2)     2736     2203
sds(t2age_slog_childes_sgenderF_3)     3035     2316
sds(t2age_slog_childes_sgenderM_1)     2270     1687
sds(t2age_slog_childes_sgenderM_2)     3028     2002
sds(t2age_slog_childes_sgenderM_3)     2984     1886

Multilevel Hyperparameters:
~participant (Number of levels: 113) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.14      0.09     0.01     0.32 1.01      773     1610

~participant:collect (Number of levels: 184) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.23      0.10     0.01     0.41 1.00      583      661

~word (Number of levels: 40) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.36      0.17     0.03     0.69 1.00      805      796

~word:stressed (Number of levels: 51) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.16     0.01     0.59 1.00      807     1827

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                          1.54      0.35     0.86     2.25 1.00
genderM                            0.02      0.13    -0.22     0.27 1.00
stopwordTRUE                      -0.57      0.45    -1.49     0.34 1.00
t2age_slog_childes_s:genderF_1    -0.31      0.23    -0.79     0.14 1.00
t2age_slog_childes_s:genderF_2     0.15      0.12    -0.09     0.39 1.00
t2age_slog_childes_s:genderF_3     0.16      0.07     0.01     0.30 1.00
t2age_slog_childes_s:genderM_1    -0.42      0.23    -0.90     0.02 1.00
t2age_slog_childes_s:genderM_2    -0.04      0.13    -0.31     0.22 1.00
t2age_slog_childes_s:genderM_3     0.11      0.09    -0.07     0.29 1.00
                               Bulk_ESS Tail_ESS
Intercept                          2016     2344
genderM                            4439     3113
stopwordTRUE                       2241     2601
t2age_slog_childes_s:genderF_1     1857     2561
t2age_slog_childes_s:genderF_2     4531     2478
t2age_slog_childes_s:genderF_3     5680     3211
t2age_slog_childes_s:genderM_1     1889     2350
t2age_slog_childes_s:genderM_2     4842     3342
t2age_slog_childes_s:genderM_3     4952     3259

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.44      0.04     1.37     1.52 1.01     4836     3081
alpha     2.24      0.30     1.69     2.87 1.00     3189     2916

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f1_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F1)"</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-119-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56"><img src="SM2_modelling_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f1_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F1)"</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-120-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57"><img src="SM2_modelling_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f1_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F1)"</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-121-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58"><img src="SM2_modelling_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>trap_f1_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    trap_f1_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    trap_f1_freq</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>trap_f1_int <span class="ot">&lt;-</span> trap_f1_preds <span class="sc">|&gt;</span> </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>trap_f1_data) <span class="sc">+</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"TRAP F1"</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>trap_f1_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-122-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59"><img src="SM2_modelling_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>trap_f1_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trap_f1_data,</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(trap_f1_fit, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f1_fit_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>trap_f1_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f1_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trap_f1_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: trap_f1_data (Number of observations: 987) 
  Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;
         total post-warmup draws = 6000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.52      0.44     0.02     1.67 1.00     3752
sds(sage_sgenderM_1)     0.55      0.44     0.02     1.65 1.00     3651
                     Tail_ESS
sds(sage_sgenderF_1)     2610
sds(sage_sgenderM_1)     2511

Multilevel Hyperparameters:
~participant (Number of levels: 115) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.14      0.09     0.01     0.32 1.00     1127     2266

~participant:collect (Number of levels: 187) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.22      0.10     0.02     0.40 1.00      941     1328

~word (Number of levels: 62) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.37      0.17     0.02     0.70 1.01      619      990

~word:stressed (Number of levels: 74) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.29      0.17     0.01     0.63 1.01      610     1868

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            1.09      0.15     0.81     1.39 1.00     7107     5284
genderM              0.06      0.11    -0.15     0.27 1.00     7539     4678
stopwordTRUE        -0.01      0.25    -0.51     0.47 1.00     3739     3952
sage_s:genderF_1     0.40      0.81    -1.24     2.03 1.00     4494     3871
sage_s:genderM_1    -0.38      0.87    -2.22     1.36 1.00     5394     3937

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.45      0.04     1.38     1.52 1.00     7840     4744
alpha     2.14      0.28     1.64     2.72 1.00     5239     4370

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f1_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F1)"</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-126-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60"><img src="SM2_modelling_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f1_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F1)"</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-127-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61"><img src="SM2_modelling_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f1_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F1)"</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-128-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62"><img src="SM2_modelling_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>trap_f1_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>    trap_f1_data,</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>    trap_f1_fit</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>trap_f1_smooth <span class="ot">&lt;-</span> trap_f1_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> trap_f1_data) <span class="sc">+</span> </span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions TRAP F1 (no freq)"</span>,</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>trap_f1_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-129-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-63"><img src="SM2_modelling_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f2-3" class="level4" data-number="4.2.0.9">
<h4 data-number="4.2.0.9" class="anchored" data-anchor-id="f2-3"><span class="header-section-number">4.2.0.9</span> F2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>trap_f2_data <span class="ot">&lt;-</span> f2 <span class="sc">|&gt;</span> </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"TRAP"</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trap_f2_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word    
 Length:963         Min.   :1.000   Min.   :-1.8406525   F:552   and    :411  
 Class :character   1st Qu.:2.000   1st Qu.:-0.5885246   M:411   nana   :137  
 Mode  :character   Median :3.000   Median : 0.1627522           that   : 96  
                    Mean   :2.883   Mean   : 0.0881186           back   : 57  
                    3rd Qu.:4.000   3rd Qu.: 0.9140289           grandma: 26  
                    Max.   :4.000   Max.   : 2.1661568           that's : 23  
                                                                 (Other):213  
  vowel      stressed        stopword          F2_lob2       
 TRAP:963   Mode :logical   Mode :logical   Min.   :-1.8241  
            FALSE:40        FALSE:352       1st Qu.: 0.1135  
            TRUE :923       TRUE :611       Median : 0.6052  
                                            Mean   : 0.5669  
                                            3rd Qu.: 1.0855  
                                            Max.   : 3.4424  
                                                             
  log_childes_s.V1       age      
 Min.   :-2.16649   Min.   :47.0  
 1st Qu.:-0.94698   1st Qu.:52.0  
 Median : 1.17969   Median :55.0  
 Mean   : 0.22815   Mean   :54.7  
 3rd Qu.: 1.17969   3rd Qu.:58.0  
 Max.   : 1.18135   Max.   :63.0  
 NA's   :41                       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>trap_f2_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trap_f2_data <span class="sc">|&gt;</span> </span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(trap_f2_freq, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f2_freq_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>trap_f2_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f2_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trap_f2_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: trap_f2_data (Number of observations: 922) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.68      0.47     0.04     1.85 1.00
sds(t2age_slog_childes_sgenderF_2)     0.93      0.57     0.05     2.18 1.00
sds(t2age_slog_childes_sgenderF_3)     0.54      0.44     0.02     1.62 1.00
sds(t2age_slog_childes_sgenderM_1)     0.47      0.40     0.02     1.51 1.00
sds(t2age_slog_childes_sgenderM_2)     0.57      0.45     0.02     1.67 1.00
sds(t2age_slog_childes_sgenderM_3)     0.57      0.46     0.02     1.76 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     1777     1456
sds(t2age_slog_childes_sgenderF_2)     1618     1503
sds(t2age_slog_childes_sgenderF_3)     2017     2060
sds(t2age_slog_childes_sgenderM_1)     2588     1995
sds(t2age_slog_childes_sgenderM_2)     2047     1629
sds(t2age_slog_childes_sgenderM_3)     2039     1560

Multilevel Hyperparameters:
~participant (Number of levels: 114) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.21      0.06     0.07     0.31 1.00      297      298

~participant:collect (Number of levels: 184) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.20      0.06     0.09     0.31 1.01      391      579

~word (Number of levels: 39) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.22      0.09     0.03     0.41 1.00      561      770

~word:stressed (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.13      0.09     0.01     0.32 1.01      358     1102

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                          0.85      0.19     0.48     1.23 1.00
genderM                           -0.26      0.09    -0.44    -0.09 1.00
stopwordTRUE                      -0.08      0.24    -0.55     0.39 1.00
t2age_slog_childes_s:genderF_1    -0.13      0.13    -0.38     0.12 1.00
t2age_slog_childes_s:genderF_2    -0.04      0.07    -0.18     0.10 1.00
t2age_slog_childes_s:genderF_3     0.02      0.04    -0.06     0.09 1.00
t2age_slog_childes_s:genderM_1    -0.17      0.13    -0.44     0.08 1.00
t2age_slog_childes_s:genderM_2    -0.06      0.08    -0.22     0.10 1.00
t2age_slog_childes_s:genderM_3     0.08      0.05    -0.02     0.17 1.00
                               Bulk_ESS Tail_ESS
Intercept                          1187     1756
genderM                            1666     2096
stopwordTRUE                       1295     2058
t2age_slog_childes_s:genderF_1     1212     1738
t2age_slog_childes_s:genderF_2     2326     2961
t2age_slog_childes_s:genderF_3     3630     3285
t2age_slog_childes_s:genderM_1     1172     1764
t2age_slog_childes_s:genderM_2     2556     2857
t2age_slog_childes_s:genderM_3     2890     2800

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.65      0.02     0.62     0.69 1.00     3394     2835
alpha    -2.38      0.35    -3.14    -1.75 1.00     1685     2152

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f2_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F2)"</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-134-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64"><img src="SM2_modelling_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f2_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F2)"</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-135-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65"><img src="SM2_modelling_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The <code>M</code> data distribution is pretty strange!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f2_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F2)"</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-136-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66"><img src="SM2_modelling_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>trap_f2_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>    trap_f2_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>    trap_f2_freq</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>trap_f2_int <span class="ot">&lt;-</span> trap_f2_preds <span class="sc">|&gt;</span> </span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>trap_f2_data) <span class="sc">+</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"TRAP F2"</span>,</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>trap_f2_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-137-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67"><img src="SM2_modelling_files/figure-html/unnamed-chunk-137-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>trap_f2_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trap_f2_data,</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(trap_f2_fit, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f2_fit_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>trap_f2_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'trap_f2_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trap_f2_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: trap_f2_data (Number of observations: 963) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.42      0.37     0.01     1.38 1.00     4361
sds(sage_sgenderM_1)     0.48      0.40     0.02     1.51 1.00     4444
                     Tail_ESS
sds(sage_sgenderF_1)     4694
sds(sage_sgenderM_1)     4515

Multilevel Hyperparameters:
~participant (Number of levels: 116) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.24      0.05     0.12     0.34 1.01      925      568

~participant:collect (Number of levels: 187) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.16      0.06     0.04     0.28 1.01      609     1023

~word (Number of levels: 62) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.28      0.11     0.04     0.48 1.00      785     1388

~word:stressed (Number of levels: 74) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.14      0.10     0.01     0.37 1.00      707     1800

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            0.58      0.09     0.39     0.76 1.00     6086     5094
genderM             -0.18      0.07    -0.33    -0.04 1.00     5852     5846
stopwordTRUE         0.19      0.15    -0.10     0.49 1.00     2873     4239
sage_s:genderF_1    -0.42      0.61    -1.80     0.75 1.00     4923     4804
sage_s:genderM_1    -0.63      0.70    -2.26     0.55 1.00     5278     5070

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.66      0.02     0.63     0.70 1.00     7330     5848
alpha    -2.39      0.35    -3.15    -1.76 1.00     4788     5338

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f2_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F2)"</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-141-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-68"><img src="SM2_modelling_files/figure-html/unnamed-chunk-141-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f2_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F2)"</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-142-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-69"><img src="SM2_modelling_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(trap_f2_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (TRAP F2)"</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-143-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-70"><img src="SM2_modelling_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>trap_f2_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>    trap_f2_data,</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    trap_f2_fit</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>trap_f2_smooth <span class="ot">&lt;-</span> trap_f2_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> trap_f2_data) <span class="sc">+</span> </span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions TRAP F2 (no freq)"</span>,</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>trap_f2_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-144-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-71"><img src="SM2_modelling_files/figure-html/unnamed-chunk-144-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  trap_f1_freq,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  trap_f1_fit,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  trap_f2_freq,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  trap_f2_fit</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<section id="f1-4" class="level4" data-number="4.2.0.10">
<h4 data-number="4.2.0.10" class="anchored" data-anchor-id="f1-4"><span class="header-section-number">4.2.0.10</span> F1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"FLEECE"</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fleece_f1_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word    
 Length:1150        Min.   :1.000   Min.   :-1.8406525   F:617   he     :453  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M:533   the    :196  
 Mode  :character   Median :3.000   Median :-0.0876734           she    :179  
                    Mean   :2.844   Mean   : 0.0205540           tui    : 67  
                    3rd Qu.:4.000   3rd Qu.: 0.6636033           he's   : 38  
                    Max.   :4.000   Max.   : 2.1661568           see    : 29  
                                                                 (Other):188  
    vowel       stressed        stopword          F1_lob2       
 FLEECE:1150   Mode :logical   Mode :logical   Min.   :-3.8044  
               FALSE:133       FALSE:242       1st Qu.:-1.5829  
               TRUE :1017      TRUE :908       Median :-1.1459  
                                               Mean   :-1.0395  
                                               3rd Qu.:-0.5851  
                                               Max.   : 3.7010  
                                                                
  log_childes_s.V1       age       
 Min.   :-2.16649   Min.   :47.00  
 1st Qu.: 0.41490   1st Qu.:51.00  
 Median : 0.82748   Median :54.00  
 Mean   : 0.62225   Mean   :54.43  
 3rd Qu.: 0.82748   3rd Qu.:57.00  
 Max.   : 1.35877   Max.   :63.00  
 NA's   :109                       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> fleece_f1_data<span class="sc">|&gt;</span> </span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(fleece_f1_freq, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f1_freq_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f1_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fleece_f1_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: fleece_f1_data (Number of observations: 1041) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.57      0.45     0.02     1.67 1.00
sds(t2age_slog_childes_sgenderF_2)     0.76      0.57     0.03     2.07 1.00
sds(t2age_slog_childes_sgenderF_3)     0.78      0.57     0.03     2.13 1.00
sds(t2age_slog_childes_sgenderM_1)     0.53      0.44     0.02     1.64 1.00
sds(t2age_slog_childes_sgenderM_2)     0.74      0.55     0.03     2.05 1.00
sds(t2age_slog_childes_sgenderM_3)     0.61      0.48     0.02     1.78 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     4646     3698
sds(t2age_slog_childes_sgenderF_2)     3582     3190
sds(t2age_slog_childes_sgenderF_3)     4068     3278
sds(t2age_slog_childes_sgenderM_1)     5234     3719
sds(t2age_slog_childes_sgenderM_2)     4455     3671
sds(t2age_slog_childes_sgenderM_3)     5618     4236

Multilevel Hyperparameters:
~participant (Number of levels: 112) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.11      0.07     0.01     0.24 1.00      537     1540

~participant:collect (Number of levels: 182) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.05     0.15     0.34 1.00     1037     1351

~word (Number of levels: 39) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.31      0.08     0.15     0.50 1.00     2029     1494

~word:stressed (Number of levels: 46) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.12      0.09     0.00     0.35 1.00     1402     2023

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                         -0.78      0.24    -1.26    -0.31 1.00
genderM                            0.01      0.08    -0.14     0.18 1.00
stopwordTRUE                      -0.26      0.28    -0.78     0.29 1.00
t2age_slog_childes_s:genderF_1     0.19      0.11    -0.03     0.42 1.00
t2age_slog_childes_s:genderF_2    -0.18      0.07    -0.32    -0.03 1.00
t2age_slog_childes_s:genderF_3     0.05      0.05    -0.06     0.15 1.00
t2age_slog_childes_s:genderM_1     0.04      0.12    -0.19     0.27 1.00
t2age_slog_childes_s:genderM_2    -0.05      0.08    -0.21     0.11 1.00
t2age_slog_childes_s:genderM_3     0.05      0.06    -0.07     0.17 1.00
                               Bulk_ESS Tail_ESS
Intercept                          2500     4544
genderM                            5015     5577
stopwordTRUE                       2259     3594
t2age_slog_childes_s:genderF_1     2359     4264
t2age_slog_childes_s:genderF_2     4835     5615
t2age_slog_childes_s:genderF_3     5513     5976
t2age_slog_childes_s:genderM_1     2495     3728
t2age_slog_childes_s:genderM_2     5215     6417
t2age_slog_childes_s:genderM_3     5512     5450

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.74      0.02     0.70     0.77 1.00     7422     5659
alpha     1.64      0.25     1.17     2.15 1.00     5821     5233

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f1_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F1)"</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-150-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-72"><img src="SM2_modelling_files/figure-html/unnamed-chunk-150-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f1_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F1)"</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-151-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73"><img src="SM2_modelling_files/figure-html/unnamed-chunk-151-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f1_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F1)"</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-152-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-74"><img src="SM2_modelling_files/figure-html/unnamed-chunk-152-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>    fleece_f1_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>    fleece_f1_freq</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>fleece_f1_int <span class="ot">&lt;-</span> fleece_f1_preds <span class="sc">|&gt;</span> </span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>fleece_f1_data) <span class="sc">+</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"FLEECE F1"</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>fleece_f1_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-153-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-75"><img src="SM2_modelling_files/figure-html/unnamed-chunk-153-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>    F1_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> fleece_f1_data,</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(fleece_f1_fit, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f1_fit_sn.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f1_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fleece_f1_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F1_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: fleece_f1_data (Number of observations: 1150) 
  Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;
         total post-warmup draws = 6000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.46      0.41     0.01     1.53 1.00     2767
sds(sage_sgenderM_1)     0.45      0.38     0.02     1.44 1.00     3202
                     Tail_ESS
sds(sage_sgenderF_1)     2912
sds(sage_sgenderM_1)     3284

Multilevel Hyperparameters:
~participant (Number of levels: 117) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.11      0.07     0.01     0.24 1.00      547     1649

~participant:collect (Number of levels: 188) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.04     0.15     0.33 1.00      844     1282

~word (Number of levels: 55) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.33      0.08     0.18     0.48 1.00     1126      533

~word:stressed (Number of levels: 64) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.11      0.09     0.00     0.34 1.01      735      504

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           -1.01      0.10    -1.21    -0.83 1.00     5793     4809
genderM             -0.02      0.07    -0.15     0.11 1.00     5358     4835
stopwordTRUE         0.04      0.16    -0.28     0.37 1.00     2888     3776
sage_s:genderF_1    -0.75      0.67    -2.34     0.45 1.00     3440     3158
sage_s:genderM_1    -0.14      0.66    -1.55     1.21 1.00     4104     3695

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.74      0.02     0.71     0.78 1.00     8066     4478
alpha     1.66      0.22     1.23     2.11 1.00     6911     5219

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f1_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F1)"</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-157-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-76"><img src="SM2_modelling_files/figure-html/unnamed-chunk-157-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f1_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F1)"</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-158-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-77"><img src="SM2_modelling_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f1_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F1)"</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-159-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-78"><img src="SM2_modelling_files/figure-html/unnamed-chunk-159-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>    fleece_f1_data,</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>    fleece_f1_fit</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>fleece_f1_smooth <span class="ot">&lt;-</span> fleece_f1_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> fleece_f1_data) <span class="sc">+</span> </span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions FLEECE F1 (no freq)"</span>,</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>fleece_f1_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-160-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-79"><img src="SM2_modelling_files/figure-html/unnamed-chunk-160-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f2-4" class="level4" data-number="4.2.0.11">
<h4 data-number="4.2.0.11" class="anchored" data-anchor-id="f2-4"><span class="header-section-number">4.2.0.11</span> F2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_data <span class="ot">&lt;-</span> f2 <span class="sc">|&gt;</span> </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"FLEECE"</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() </span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fleece_f2_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> participant           collect            age_s.V1       gender       word    
 Length:1159        Min.   :1.000   Min.   :-1.8406525   F:628   he     :448  
 Class :character   1st Qu.:2.000   1st Qu.:-0.8389502   M:531   the    :203  
 Mode  :character   Median :3.000   Median :-0.0876734           she    :180  
                    Mean   :2.833   Mean   : 0.0242510           tui    : 66  
                    3rd Qu.:4.000   3rd Qu.: 0.6636033           he's   : 38  
                    Max.   :4.000   Max.   : 2.1661568           see    : 29  
                                                                 (Other):195  
    vowel       stressed        stopword          F2_lob2       
 FLEECE:1159   Mode :logical   Mode :logical   Min.   :-1.8586  
               FALSE:132       FALSE:242       1st Qu.: 0.7574  
               TRUE :1027      TRUE :917       Median : 1.6056  
                                               Mean   : 1.4325  
                                               3rd Qu.: 2.1571  
                                               Max.   : 5.1832  
                                                                
  log_childes_s.V1       age       
 Min.   :-2.16649   Min.   :47.00  
 1st Qu.: 0.41490   1st Qu.:51.00  
 Median : 0.82748   Median :54.00  
 Mean   : 0.62215   Mean   :54.45  
 3rd Qu.: 0.82748   3rd Qu.:57.00  
 Max.   : 1.35877   Max.   :63.00  
 NA's   :111                       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_freq <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t2</span>(age_s, log_childes_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> fleece_f2_data <span class="sc">|&gt;</span> </span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_na</span>(),</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>  fleece_f2_freq, </span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f2_freq_sn.rds'</span>), </span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_freq <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f2_freq_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fleece_f2_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + t2(age_s, log_childes_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: fleece_f2_data (Number of observations: 1048) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                                   Estimate Est.Error l-95% CI u-95% CI Rhat
sds(t2age_slog_childes_sgenderF_1)     0.94      0.64     0.04     2.37 1.00
sds(t2age_slog_childes_sgenderF_2)     0.69      0.52     0.03     1.92 1.00
sds(t2age_slog_childes_sgenderF_3)     0.85      0.55     0.05     2.09 1.00
sds(t2age_slog_childes_sgenderM_1)     0.57      0.45     0.02     1.65 1.00
sds(t2age_slog_childes_sgenderM_2)     0.65      0.51     0.02     1.88 1.00
sds(t2age_slog_childes_sgenderM_3)     0.65      0.51     0.03     1.88 1.00
                                   Bulk_ESS Tail_ESS
sds(t2age_slog_childes_sgenderF_1)     3734     3941
sds(t2age_slog_childes_sgenderF_2)     5823     4689
sds(t2age_slog_childes_sgenderF_3)     5136     4234
sds(t2age_slog_childes_sgenderM_1)     5830     3822
sds(t2age_slog_childes_sgenderM_2)     6052     4296
sds(t2age_slog_childes_sgenderM_3)     6353     4159

Multilevel Hyperparameters:
~participant (Number of levels: 113) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.07     0.01     0.27 1.01      698     1519

~participant:collect (Number of levels: 184) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.07     0.01     0.28 1.01      600     1730

~word (Number of levels: 39) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.36      0.09     0.18     0.55 1.00     2265     1466

~word:stressed (Number of levels: 46) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.12      0.10     0.00     0.37 1.00     1833     1872

Regression Coefficients:
                               Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                          1.38      0.25     0.88     1.88 1.00
genderM                            0.03      0.08    -0.12     0.19 1.00
stopwordTRUE                      -0.05      0.29    -0.63     0.51 1.00
t2age_slog_childes_s:genderF_1    -0.12      0.12    -0.35     0.11 1.00
t2age_slog_childes_s:genderF_2    -0.05      0.07    -0.19     0.09 1.00
t2age_slog_childes_s:genderF_3    -0.06      0.05    -0.17     0.04 1.00
t2age_slog_childes_s:genderM_1    -0.05      0.12    -0.29     0.19 1.00
t2age_slog_childes_s:genderM_2    -0.06      0.08    -0.21     0.10 1.00
t2age_slog_childes_s:genderM_3     0.04      0.06    -0.09     0.16 1.00
                               Bulk_ESS Tail_ESS
Intercept                          3652     4752
genderM                            8020     6211
stopwordTRUE                       4045     4889
t2age_slog_childes_s:genderF_1     3919     4824
t2age_slog_childes_s:genderF_2     8572     6298
t2age_slog_childes_s:genderF_3     8245     6449
t2age_slog_childes_s:genderM_1     3740     4667
t2age_slog_childes_s:genderM_2     7632     6642
t2age_slog_childes_s:genderM_3     7385     6151

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.80      0.02     0.76     0.84 1.00     8746     6193
alpha    -2.26      0.24    -2.76    -1.84 1.00     6717     5435

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f2_freq, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F2)"</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-165-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-80"><img src="SM2_modelling_files/figure-html/unnamed-chunk-165-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f2_freq, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F2)"</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-166-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-81"><img src="SM2_modelling_files/figure-html/unnamed-chunk-166-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The <code>M</code> data distribution is pretty strange!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f2_freq, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F2)"</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-167-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-82"><img src="SM2_modelling_files/figure-html/unnamed-chunk-167-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_preds <span class="ot">&lt;-</span> <span class="fu">interaction_preds</span>(</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>    fleece_f2_data <span class="sc">|&gt;</span>  <span class="fu">drop_na</span>(),</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>    fleece_f2_freq</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>fleece_f2_int <span class="ot">&lt;-</span> fleece_f2_preds <span class="sc">|&gt;</span> </span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interaction_plot</span>(<span class="at">data=</span>fleece_f2_data) <span class="sc">+</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"FLEECE F2"</span>,</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Word frequency and formant values"</span>,</span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Est. (Lob 2.0)"</span>,</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled log corpus frequency"</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>fleece_f2_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-168-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-83"><img src="SM2_modelling_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>    F2_lob2 <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> fleece_f2_data,</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a>  fleece_f2_fit, </span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f2_fit_sn.rds'</span>), </span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_fit <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f2_fit_sn.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fleece_f2_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: skew_normal 
  Links: mu = identity; sigma = identity; alpha = identity 
Formula: F2_lob2 ~ gender + stopword + s(age_s, by = gender, k = 5) + (1 | word/stressed) + (1 | participant/collect) 
   Data: fleece_f2_data (Number of observations: 1159) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sage_sgenderF_1)     0.65      0.45     0.04     1.77 1.00     3172
sds(sage_sgenderM_1)     0.45      0.40     0.02     1.48 1.00     3920
                     Tail_ESS
sds(sage_sgenderF_1)     2659
sds(sage_sgenderM_1)     3851

Multilevel Hyperparameters:
~participant (Number of levels: 116) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.16      0.06     0.02     0.26 1.00      613     1072

~participant:collect (Number of levels: 188) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.15      0.07     0.01     0.27 1.00      585     1185

~word (Number of levels: 54) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.46      0.11     0.21     0.67 1.00      717      412

~word:stressed (Number of levels: 63) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.17      0.13     0.01     0.49 1.01      596      488

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            1.48      0.12     1.26     1.71 1.00     5491     6424
genderM             -0.02      0.06    -0.15     0.11 1.00     6387     5907
stopwordTRUE        -0.28      0.21    -0.71     0.15 1.00     2676     3830
sage_s:genderF_1    -0.19      0.74    -1.60     1.40 1.00     4922     5140
sage_s:genderM_1    -0.29      0.66    -1.75     0.97 1.00     4789     4578

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.80      0.02     0.77     0.84 1.00     7755     5757
alpha    -2.22      0.23    -2.69    -1.79 1.00     6616     5777

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f2_fit, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F2)"</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-172-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-84"><img src="SM2_modelling_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f2_fit, <span class="at">type=</span><span class="st">"dens_overlay_grouped"</span>, <span class="at">group=</span><span class="st">"gender"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F2)"</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-173-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-85"><img src="SM2_modelling_files/figure-html/unnamed-chunk-173-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fleece_f2_fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>), <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PPD check (FLEECE F2)"</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-174-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-86"><img src="SM2_modelling_files/figure-html/unnamed-chunk-174-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>fleece_f2_nofreq_preds <span class="ot">&lt;-</span> <span class="fu">smooth_preds</span>(</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    fleece_f2_data,</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    fleece_f2_fit</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>fleece_f2_smooth <span class="ot">&lt;-</span> fleece_f2_nofreq_preds <span class="sc">|&gt;</span> </span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smooth_plot</span>(<span class="at">data =</span> fleece_f2_data) <span class="sc">+</span> </span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model predictions FLEECE F2 (no freq)"</span>,</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Gender"</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>fleece_f2_smooth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-175-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-87"><img src="SM2_modelling_files/figure-html/unnamed-chunk-175-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
<section id="note-on-model-fit" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="note-on-model-fit"><span class="header-section-number">4.3</span> Note on model fit</h2>
<p>The model of <span class="smallcaps">kit</span> F2 without frequency reports a single divergent transition after warmup. This seems to result from difficulties sampling from the complex hierarchical structure in the model. In particular, the nesting of stressed within word leads to a very large number of levels for which random intercepts are estimated.</p>
</section>
</section>
<section id="quakebox-models" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> QuakeBox models</h1>
<section id="fit" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="fit"><span class="header-section-number">5.1</span> Fit</h2>
<p>Here we fit GAMM models with similar structures to the QuakeBox (QB). Rather than using <code>brms</code> we use the <code>mgcv</code> package directly. The Bayesian methods for fitting GAMMs used above have many advantages, but they lack the computational efficiency which we require for QB. QB is <em>much</em> larger than our preschool corpus. Moreover, the flexibility we took advantage of in setting our prior is not necessary for the QuakeBox. Unfortunately, we cannot fit a model with a skew-normal response. We use a scaled-t response to capture the large tails in the residuals.</p>
<p>We borrow code from another project (ANONYMISED). We modify the anonymisation script from that project in order to create a stopword variable. The norm in sharing QuakeBox data is that <em>words</em> are anonymised. Free narratives contain identifying details which are absent in not in story retell data.</p>
<p>This is a very long section of code, so we have ‘folded’ it by default.</p>
<p>First we load up the data and get some counts which we will add to the paper.</p>
<div class="cell">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>QB1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'QB1.rds'</span>))</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check age factor is in the right order.</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>QB1<span class="sc">$</span>age <span class="sc">|&gt;</span> <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">levels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "18-25" "26-35" "36-45" "46-55" "56-65" "66-75" "76-85" "85+"  </code></pre>
</div>
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "18-25" "26-35" "36-45" "46-55" "56-65" "66-75" "76-85" "85+"  </span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="co"># yes</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Various variable changes in order to fit a GAMM. With mgcv, it is important</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to be explicit about whether a variable is a factor. We scale variables in </span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="co"># order to improve model fit and ease of interpretation.</span></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>QB1 <span class="ot">&lt;-</span> QB1 <span class="sc">%&gt;%</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_category_numeric =</span> <span class="fu">as.integer</span>(<span class="fu">factor</span>(age)),</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">speaker =</span> <span class="fu">as.factor</span>(speaker),</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">as.factor</span>(gender),</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">word =</span> <span class="fu">as.factor</span>(word),</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">stopword =</span> <span class="fu">as.factor</span>(stopword),</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">unstressed =</span> <span class="fu">as.factor</span>(unstressed),</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_freq =</span> <span class="fu">log</span>(celex_frequency <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_log_freq =</span> <span class="fu">scale</span>(log_freq),</span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_age_cat =</span> <span class="fu">scale</span>(age_category_numeric)</span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a>QB1_caregivercount <span class="ot">&lt;-</span> QB1 <span class="sc">|&gt;</span> </span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"DRESS"</span>,</span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"FLEECE"</span>,</span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"TRAP"</span>,</span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"KIT"</span>,</span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"NURSE"</span></span>
<span id="cb210-28"><a href="#cb210-28" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb210-29"><a href="#cb210-29" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"f"</span>,</span>
<span id="cb210-30"><a href="#cb210-30" aria-hidden="true" tabindex="-1"></a>    age_category_numeric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb210-31"><a href="#cb210-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb210-32"><a href="#cb210-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb210-33"><a href="#cb210-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n_distinct</span>(speaker)</span>
<span id="cb210-34"><a href="#cb210-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb210-35"><a href="#cb210-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 25461 tokens from notional caregiver generation.</span></span>
<span id="cb210-36"><a href="#cb210-36" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Tokens from caregiver generation: '</span>, <span class="fu">nrow</span>(QB1_caregivercount), <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Tokens from caregiver generation:  25461 </code></pre>
</div>
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>QB1_oldestgeneration <span class="ot">&lt;-</span> QB1 <span class="sc">|&gt;</span> </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">"DRESS"</span>,</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"FLEECE"</span>,</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"TRAP"</span>,</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"KIT"</span>,</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"NURSE"</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"f"</span>,</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>    age_category_numeric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n_distinct</span>(speaker)</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 9379 tokens from oldest generation.</span></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Tokens from oldest generation: '</span>, <span class="fu">nrow</span>(QB1_oldestgeneration), <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Tokens from oldest generation:  5077 </code></pre>
</div>
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 45 speakers in notional caregiver generation.</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Caregivers: '</span>, QB1_caregivercount<span class="sc">$</span>n[[<span class="dv">1</span>]], <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Caregivers:  45 </code></pre>
</div>
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 18 speakers in oldest generation</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Oldest: '</span>, QB1_oldestgeneration<span class="sc">$</span>n[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Oldest:  10</code></pre>
</div>
</div>
<p>Now we fit the models specified here uses nearly 40GB of RAM. Researchers with less access to computation may need to fit the models one-at-a-time rather than keeping all in memory at once.</p>
<div class="cell">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>QB1_freq_models <span class="ot">&lt;-</span> QB1 <span class="sc">|&gt;</span> </span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>F1_50, <span class="sc">-</span>F2_50</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> F1_lob2<span class="sc">:</span>F2_lob2,</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"formant_type"</span>,</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"formant_value"</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, formant_type) <span class="sc">%&gt;%</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">map</span>(</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>      data,</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">bam</span>(</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>          formant_value <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">te</span>(age_category_numeric, s_log_freq, <span class="at">k =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">10</span>), <span class="at">by =</span> gender) <span class="sc">+</span></span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(articulation_rate, <span class="at">k =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="co"># control vars</span></span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(speaker, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span> <span class="fu">s</span>(word, <span class="at">by=</span>unstressed, <span class="at">bs=</span><span class="st">'re'</span>), <span class="co"># random effects</span></span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">nthreads =</span> <span class="dv">8</span>, </span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> mgcv<span class="sc">::</span><span class="fu">scat</span>(<span class="at">link =</span><span class="st">'identity'</span>),</span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> .x</span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(QB1_freq_models, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'QB1_freq_models.rds'</span>), <span class="at">compress=</span><span class="st">"gz"</span>)</span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll remove these models from memory and reload them later. First, we need</span></span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a><span class="co"># to fit the models without frequency.</span></span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(QB1_freq_models)</span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>QB1_models <span class="ot">&lt;-</span> QB1 <span class="sc">%&gt;%</span></span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>F1_50, <span class="sc">-</span>F2_50</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> F1_lob2<span class="sc">:</span>F2_lob2,</span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"formant_type"</span>,</span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"formant_value"</span></span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, formant_type) <span class="sc">%&gt;%</span></span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">map</span>(</span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>      data,</span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">bam</span>(</span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a>        formant_value <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(age_category_numeric, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">by =</span> gender) <span class="sc">+</span></span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(articulation_rate, <span class="at">k =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="co"># control vars</span></span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(speaker, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span> <span class="fu">s</span>(word, <span class="at">by=</span>unstressed, <span class="at">bs=</span><span class="st">'re'</span>), <span class="co"># random effects</span></span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">nthreads =</span> <span class="dv">8</span>, <span class="co"># This value is too high for most situations.</span></span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> mgcv<span class="sc">::</span><span class="fu">scat</span>(<span class="at">link =</span><span class="st">'identity'</span>),</span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> .x</span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb218-58"><a href="#cb218-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb218-59"><a href="#cb218-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb218-60"><a href="#cb218-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-61"><a href="#cb218-61" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(QB1_models, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'QB1_models.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For the models without frequency we’ll also generate summaries and extract p-values for comparison with previous results.</p>
<div class="cell">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>QB1_models <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'QB1_models.rds'</span>))</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>QB1_models <span class="ot">&lt;-</span> QB1_models <span class="sc">|&gt;</span> </span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_smooth_pvs =</span> <span class="fu">map</span>(</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>      model,</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">summary</span>(.x, <span class="at">re.test =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>s.pv</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">genderF_smooth_pv =</span> <span class="fu">map_dbl</span>(</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>      model_smooth_pvs,</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> .x[[<span class="dv">1</span>]]</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">genderM_smooth_pv =</span> <span class="fu">map_dbl</span>(</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>      model_smooth_pvs,</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> .x[[<span class="dv">2</span>]]</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(QB1_models, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'QN1_models.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>QB1_models <span class="sc">|&gt;</span> </span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vowel <span class="sc">%in%</span> short_front) <span class="sc">|&gt;</span> </span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vowel, formant_type, <span class="fu">contains</span>(<span class="st">'smooth_pv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="generate-predictions-and-plot" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="generate-predictions-and-plot"><span class="header-section-number">5.2</span> Generate predictions and plot</h2>
<p>For these plots, we use the models without word frequency.</p>
<div class="cell">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>QB1_models <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'QB1_models.rds'</span>))</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>caregiver_preds <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_predictions</span>(</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    model,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">list</span>(</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">gender =</span> <span class="st">"f"</span>,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">age_category_numeric =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">stopword =</span> <span class="cn">FALSE</span>,</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">unstressed =</span> <span class="cn">FALSE</span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>oldest_preds <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_predictions</span>(</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>    model,</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">list</span>(</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">Gender =</span> <span class="fu">c</span>(<span class="st">"f"</span>),</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">age_category_numeric =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">stopword =</span> <span class="cn">FALSE</span>,</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">unstressed =</span> <span class="cn">FALSE</span></span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>QB1_models <span class="ot">&lt;-</span> QB1_models <span class="sc">|&gt;</span> </span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">cg_pred =</span> <span class="fu">map</span>(model, caregiver_preds),</span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">oldest_pred =</span> <span class="fu">map</span>(model, oldest_preds)</span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb220-32"><a href="#cb220-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-33"><a href="#cb220-33" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> QB1_models <span class="sc">|&gt;</span> </span>
<span id="cb220-34"><a href="#cb220-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vowel, formant_type, cg_pred, oldest_pred) <span class="sc">|&gt;</span> </span>
<span id="cb220-35"><a href="#cb220-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb220-36"><a href="#cb220-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"cg_pred"</span>, <span class="st">"oldest_pred"</span>),</span>
<span id="cb220-37"><a href="#cb220-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"prediction_type"</span>,</span>
<span id="cb220-38"><a href="#cb220-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"pred_value"</span></span>
<span id="cb220-39"><a href="#cb220-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb220-40"><a href="#cb220-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pred_value)</span>
<span id="cb220-41"><a href="#cb220-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-42"><a href="#cb220-42" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(preds, <span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'QB1_cg_old_preds.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'QB1_cg_old_preds.rds'</span>))</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>plot_preds <span class="ot">&lt;-</span> preds <span class="sc">|&gt;</span> </span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, formant_type, gender, prediction_type) <span class="sc">|&gt;</span> </span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_formant_value =</span> <span class="fu">mean</span>(fit)</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> formant_type, <span class="at">values_from =</span> mean_formant_value</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>plot_preds <span class="sc">|&gt;</span> </span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DRESS"</span>, <span class="st">"FLEECE"</span>, <span class="st">"NURSE"</span>, <span class="st">"TRAP"</span>, <span class="st">"KIT"</span>)</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2,</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> prediction_type</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>() <span class="sc">+</span></span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-180-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-88"><img src="SM2_modelling_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This is about what we would expect for our reference values.</p>
<p>We plot change over time, again borrowing code from Hurring et al.&nbsp;(Under Review). We restrict the vowels to the extended front vowel shift.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>to_predict <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_category_numeric =</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">7</span>, <span class="at">by=</span><span class="dv">1</span>), <span class="co"># All age categories.</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">c</span>(<span class="st">"m"</span>, <span class="st">"f"</span>),</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">stopword =</span> <span class="cn">FALSE</span>,</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">unstressed =</span> <span class="cn">FALSE</span> <span class="co"># NB: this isn't actually doing anything as random effects</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># are cancelled by get_predictions.</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>QB1_preds <span class="ot">&lt;-</span> QB1_models <span class="sc">%&gt;%</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">prediction =</span> <span class="fu">map</span>(</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>      model,</span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">get_predictions</span>(<span class="at">model =</span> .x, <span class="at">cond =</span> to_predict, <span class="at">print.summary =</span> <span class="cn">FALSE</span>)</span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>    vowel, formant_type, prediction</span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(prediction) <span class="sc">%&gt;%</span></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This step is important. It ensures that, when we plot,</span></span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrows go from oldest to youngest speakers.</span></span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(</span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">desc</span>(age_category_numeric)</span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(QB1_preds, <span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'QB1_preds.rds'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>QB1_preds <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'QB1_preds.rds'</span>))</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>QB1_preds <span class="ot">&lt;-</span> QB1_preds <span class="sc">%&gt;%</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>articulation_rate,</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>( <span class="co"># Pivot</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> formant_type,</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(fit, CI)</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">F1_lob2 =</span> fit_F1_lob2,</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">F2_lob2 =</span> fit_F2_lob2</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">if_else</span>(gender <span class="sc">==</span> <span class="st">"m"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>),</span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>))</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Tol colours, designed to be colour blind friendly.</span></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>vowel_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">DRESS =</span> <span class="st">"#777777"</span>, <span class="co"># This is the 'bad data' colour for maps </span></span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">FLEECE =</span> <span class="st">"#882E72"</span>,</span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">KIT =</span> <span class="st">"#7BAFDE"</span>,</span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">TRAP =</span> <span class="st">"#F7F056"</span>,</span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">NURSE =</span> <span class="st">"#E8601C"</span></span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the following vector to reorder the vowel vector and thus control</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a><span class="co"># the order in which vowels appear in the legend of our plots.</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>vowels_order <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FLEECE"</span>, <span class="st">"DRESS"</span>, <span class="st">"NURSE"</span>, <span class="st">"KIT"</span>, <span class="st">"TRAP"</span></span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up some functions for often-repeated plotting code.</span></span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>qb_mapping <span class="ot">&lt;-</span> <span class="fu">aes</span>(</span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> F2_lob2,</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> F1_lob2,</span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">colour =</span> vowel,</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> vowel_lab,</span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> vowel</span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>vs_layers <span class="ot">&lt;-</span> <span class="cf">function</span>(in_plot) {</span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> in_plot <span class="sc">+</span></span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(</span>
<span id="cb223-47"><a href="#cb223-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrow =</span> <span class="fu">arrow</span>(</span>
<span id="cb223-48"><a href="#cb223-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">ends =</span> <span class="st">"last"</span>, </span>
<span id="cb223-49"><a href="#cb223-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">type=</span><span class="st">"closed"</span>,</span>
<span id="cb223-50"><a href="#cb223-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)</span>
<span id="cb223-51"><a href="#cb223-51" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb223-52"><a href="#cb223-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb223-53"><a href="#cb223-53" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb223-54"><a href="#cb223-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb223-55"><a href="#cb223-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="sc">~</span> .x <span class="sc">%&gt;%</span> </span>
<span id="cb223-56"><a href="#cb223-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb223-57"><a href="#cb223-57" aria-hidden="true" tabindex="-1"></a>          <span class="sc">!</span>vowel_lab <span class="sc">==</span> <span class="st">""</span></span>
<span id="cb223-58"><a href="#cb223-58" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb223-59"><a href="#cb223-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb223-60"><a href="#cb223-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb223-61"><a href="#cb223-61" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb223-62"><a href="#cb223-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label_repel</span>(</span>
<span id="cb223-63"><a href="#cb223-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb223-64"><a href="#cb223-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb223-65"><a href="#cb223-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb223-66"><a href="#cb223-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">10</span> <span class="sc">/</span> .pt,</span>
<span id="cb223-67"><a href="#cb223-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>),</span>
<span id="cb223-68"><a href="#cb223-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb223-69"><a href="#cb223-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">max.overlaps =</span> <span class="cn">Inf</span></span>
<span id="cb223-70"><a href="#cb223-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb223-71"><a href="#cb223-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-72"><a href="#cb223-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-73"><a href="#cb223-73" aria-hidden="true" tabindex="-1"></a>vs_scales <span class="ot">&lt;-</span> <span class="cf">function</span>(in_plot) {</span>
<span id="cb223-74"><a href="#cb223-74" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> in_plot <span class="sc">+</span></span>
<span id="cb223-75"><a href="#cb223-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.2</span>), <span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb223-76"><a href="#cb223-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>), <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb223-77"><a href="#cb223-77" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_linetype_manual(values = c('FALSE' = "dotted", 'TRUE' = "solid")) +</span></span>
<span id="cb223-78"><a href="#cb223-78" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_linewidth_manual(values = c('FALSE' = 0.5, 'TRUE' = 1)) +</span></span>
<span id="cb223-79"><a href="#cb223-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> vowel_colours_5) <span class="sc">+</span></span>
<span id="cb223-80"><a href="#cb223-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(</span>
<span id="cb223-81"><a href="#cb223-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">vars</span>(gender)</span>
<span id="cb223-82"><a href="#cb223-82" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb223-83"><a href="#cb223-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-84"><a href="#cb223-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-85"><a href="#cb223-85" aria-hidden="true" tabindex="-1"></a>vs_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(in_plot) {</span>
<span id="cb223-86"><a href="#cb223-86" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> in_plot <span class="sc">+</span> </span>
<span id="cb223-87"><a href="#cb223-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb223-88"><a href="#cb223-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"F2 (normalised)"</span>,</span>
<span id="cb223-89"><a href="#cb223-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"F1 (normalised)"</span></span>
<span id="cb223-90"><a href="#cb223-90" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb223-91"><a href="#cb223-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb223-92"><a href="#cb223-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb223-93"><a href="#cb223-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb223-94"><a href="#cb223-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position=</span><span class="st">"none"</span></span>
<span id="cb223-95"><a href="#cb223-95" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb223-96"><a href="#cb223-96" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-97"><a href="#cb223-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-98"><a href="#cb223-98" aria-hidden="true" tabindex="-1"></a>add_labels <span class="ot">&lt;-</span> <span class="cf">function</span>(in_data) {</span>
<span id="cb223-99"><a href="#cb223-99" aria-hidden="true" tabindex="-1"></a>  out_data <span class="ot">&lt;-</span> in_data <span class="sc">%&gt;%</span></span>
<span id="cb223-100"><a href="#cb223-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(vowel, gender) <span class="sc">%&gt;%</span></span>
<span id="cb223-101"><a href="#cb223-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb223-102"><a href="#cb223-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">vowel_lab =</span> <span class="fu">if_else</span>(</span>
<span id="cb223-103"><a href="#cb223-103" aria-hidden="true" tabindex="-1"></a>        age_category_numeric <span class="sc">==</span> <span class="fu">max</span>(age_category_numeric),</span>
<span id="cb223-104"><a href="#cb223-104" aria-hidden="true" tabindex="-1"></a>        vowel,</span>
<span id="cb223-105"><a href="#cb223-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span></span>
<span id="cb223-106"><a href="#cb223-106" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb223-107"><a href="#cb223-107" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb223-108"><a href="#cb223-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb223-109"><a href="#cb223-109" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-110"><a href="#cb223-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-111"><a href="#cb223-111" aria-hidden="true" tabindex="-1"></a>qb_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(in_data) {</span>
<span id="cb223-112"><a href="#cb223-112" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> in_data <span class="sc">%&gt;%</span> </span>
<span id="cb223-113"><a href="#cb223-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_labels</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb223-114"><a href="#cb223-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb223-115"><a href="#cb223-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> qb_mapping</span>
<span id="cb223-116"><a href="#cb223-116" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb223-117"><a href="#cb223-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vs_layers</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb223-118"><a href="#cb223-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vs_scales</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb223-119"><a href="#cb223-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vs_theme</span>()</span>
<span id="cb223-120"><a href="#cb223-120" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-121"><a href="#cb223-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-122"><a href="#cb223-122" aria-hidden="true" tabindex="-1"></a>QB1_plot <span class="ot">&lt;-</span> QB1_preds <span class="sc">|&gt;</span> </span>
<span id="cb223-123"><a href="#cb223-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb223-124"><a href="#cb223-124" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> vowels_order</span>
<span id="cb223-125"><a href="#cb223-125" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb223-126"><a href="#cb223-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qb_plot</span>()</span>
<span id="cb223-127"><a href="#cb223-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-128"><a href="#cb223-128" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb223-129"><a href="#cb223-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'QB1.tiff'</span>),</span>
<span id="cb223-130"><a href="#cb223-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> QB1_plot,</span>
<span id="cb223-131"><a href="#cb223-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb223-132"><a href="#cb223-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb223-133"><a href="#cb223-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb223-134"><a href="#cb223-134" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-135"><a href="#cb223-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-136"><a href="#cb223-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-137"><a href="#cb223-137" aria-hidden="true" tabindex="-1"></a>QB1_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-182-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-89"><img src="SM2_modelling_files/figure-html/unnamed-chunk-182-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>These follow basically the same story as the combined plot from Hurring et al.&nbsp;(Figure 1 in the paper). There are some minor shifts. But these do not affect the big picture interpretation.</p>
<p>Are the change over time smooths significant?</p>
<div class="cell">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This block requires the previous 'eval:false' chunks in this section to have been run.</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  QB1_models<span class="sc">$</span>model,</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will further explore these models in future work.</p>
</section>
</section>
<section id="plots" class="level1 page-columns page-full" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Plots</h1>
<p>Having fit a models for each vowel, we create plots combining the model predictions with reference information from the commiunity and the storyteller.</p>
<section id="comparison-plots" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="comparison-plots"><span class="header-section-number">6.1</span> Comparison plots</h2>
<p>The first set of plots combine our models <em>without word frequency</em> from the preschoolers and the QuakeBox.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># As often above, we establish a function and then apply it to multiple models.</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We take the raw data as an input in order to plot a 'rug' underneath the</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># smooths.</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>comp_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model_preds, qb_prediction, data) {</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>  mean_formant <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="fu">contains</span>(<span class="st">'_lob2'</span>)) <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> model_preds <span class="sc">|&gt;</span> </span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> age,</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> .epred,</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> .epred.lower,</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> .epred.upper,</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> gender</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">yintercept =</span> caregiver_level, </span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> label</span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> qb_prediction</span>
<span id="cb225-26"><a href="#cb225-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb225-27"><a href="#cb225-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rug</span>(</span>
<span id="cb225-28"><a href="#cb225-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb225-29"><a href="#cb225-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> age,</span>
<span id="cb225-30"><a href="#cb225-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> dummy,</span>
<span id="cb225-31"><a href="#cb225-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> gender</span>
<span id="cb225-32"><a href="#cb225-32" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb225-33"><a href="#cb225-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">sides =</span> <span class="st">"b"</span>, </span>
<span id="cb225-34"><a href="#cb225-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data <span class="sc">|&gt;</span> </span>
<span id="cb225-35"><a href="#cb225-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb225-36"><a href="#cb225-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">dummy =</span> <span class="fu">seq</span>(</span>
<span id="cb225-37"><a href="#cb225-37" aria-hidden="true" tabindex="-1"></a>            mean_formant <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb225-38"><a href="#cb225-38" aria-hidden="true" tabindex="-1"></a>            mean_formant <span class="sc">+</span> <span class="fl">0.1</span>, </span>
<span id="cb225-39"><a href="#cb225-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">length.out =</span> <span class="fu">nrow</span>(data)</span>
<span id="cb225-40"><a href="#cb225-40" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb225-41"><a href="#cb225-41" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb225-42"><a href="#cb225-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">inherit.aes=</span><span class="cn">FALSE</span>, </span>
<span id="cb225-43"><a href="#cb225-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">position=</span><span class="st">"jitter"</span></span>
<span id="cb225-44"><a href="#cb225-44" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb225-45"><a href="#cb225-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb225-46"><a href="#cb225-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb225-47"><a href="#cb225-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Model predictions QB1 vs Kids"</span>,</span>
<span id="cb225-48"><a href="#cb225-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb225-49"><a href="#cb225-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Normalised formant value (predicted)"</span>,</span>
<span id="cb225-50"><a href="#cb225-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">"Gender"</span>,</span>
<span id="cb225-51"><a href="#cb225-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"Reference"</span></span>
<span id="cb225-52"><a href="#cb225-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb225-53"><a href="#cb225-53" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We use the reference values from out QuakeBox models derived above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">|&gt;</span> </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">str_to_upper</span>(gender)</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>caregivers <span class="ot">&lt;-</span> preds <span class="sc">|&gt;</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age_category_numeric <span class="sc">&lt;</span> <span class="dv">3</span>, gender<span class="sc">==</span><span class="st">"F"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, formant_type) <span class="sc">|&gt;</span> </span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">caregiver_level =</span> <span class="fu">mean</span>(fit)</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Caregiver level"</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>oldest_generation <span class="ot">&lt;-</span> preds <span class="sc">|&gt;</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age_category_numeric <span class="sc">&gt;</span> <span class="dv">6</span>, gender<span class="sc">==</span><span class="st">"F"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, formant_type) <span class="sc">|&gt;</span> </span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caregiver_level =</span> <span class="fu">mean</span>(fit)</span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Oldest level"</span></span>
<span id="cb226-24"><a href="#cb226-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now apply the plot function to each of the models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>comp_plots <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">vowel =</span> <span class="fu">c</span>(<span class="st">"DRESS"</span>, <span class="st">"FLEECE"</span>, <span class="st">"KIT"</span>, <span class="st">"NURSE"</span>, <span class="st">"TRAP"</span>),</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formant_type =</span> <span class="fu">c</span>(<span class="st">"F1_lob2"</span>, <span class="st">"F2_lob2"</span>)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>mod_predictions <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  dress_f1_preds,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>  dress_f2_nofreq_preds,</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  fleece_f1_nofreq_preds,</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  fleece_f2_nofreq_preds,</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>  kit_f1_nofreq_preds,</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  kit_f2_nofreq_preds,</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  nurse_f1_nofreq_preds,</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>  nurse_f2_nofreq_preds,</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>  trap_f1_nofreq_preds,</span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>  trap_f2_nofreq_preds</span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>mod_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>  dress_f1_data,</span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>  dress_f2_data,</span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>  fleece_f1_data,</span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>  fleece_f2_data,</span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>  kit_f1_data,</span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>  kit_f2_data,</span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>  nurse_f1_data,</span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>  nurse_f2_data,</span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a>  trap_f1_data,</span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a>  trap_f2_data</span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>comp_plots <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictions =</span> mod_predictions,</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mod_data</span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>comp_plots <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span></span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="fu">pmap</span>(</span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(vowel, formant_type, predictions, data),</span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>      \(x, y, z, dat) {</span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">comp_plot</span>(</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>          z <span class="sc">|&gt;</span> </span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(</span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>              <span class="fu">between</span>(age, <span class="dv">47</span>, <span class="dv">62</span>)</span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a>          caregivers <span class="sc">|&gt;</span> </span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(</span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>              vowel <span class="sc">==</span> x,</span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>              formant_type <span class="sc">==</span> y</span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> dat</span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="fu">paste0</span>(x, <span class="st">" "</span>, y)</span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  comp_plots<span class="sc">$</span>plot,</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-1.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-1.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-2.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-2.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-3.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-3.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-4.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-4.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-5.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-5.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-6.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-6.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-7.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-7.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-8.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-8.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-9.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-9.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-187-10.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-187-10.png" class="img-fluid" width="672"></a></p>
</div>
</div>
</div>
<p>We output a figure for the paper here selecting <span class="smallcaps">fleece</span> F1, <span class="smallcaps">dress</span> F1, <span class="smallcaps">kit</span> F1 and F2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"FLEECE"</span>,</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>    formant_type <span class="sc">==</span> <span class="st">"F1_lob2"</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(plot) <span class="sc">|&gt;</span> </span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"DRESS"</span>,</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>    formant_type <span class="sc">==</span> <span class="st">"F1_lob2"</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(plot) <span class="sc">|&gt;</span> </span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>plot_3 <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"KIT"</span>,</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a>    formant_type <span class="sc">==</span> <span class="st">"F1_lob2"</span></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(plot) <span class="sc">|&gt;</span> </span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>plot_4 <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"KIT"</span>,</span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a>    formant_type <span class="sc">==</span> <span class="st">"F2_lob2"</span></span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb229-30"><a href="#cb229-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(plot) <span class="sc">|&gt;</span> </span>
<span id="cb229-31"><a href="#cb229-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb229-32"><a href="#cb229-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-33"><a href="#cb229-33" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (plot_1 <span class="sc">+</span> plot_2) <span class="sc">/</span></span>
<span id="cb229-34"><a href="#cb229-34" aria-hidden="true" tabindex="-1"></a>  (plot_3 <span class="sc">+</span> plot_4) <span class="sc">+</span></span>
<span id="cb229-35"><a href="#cb229-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb229-36"><a href="#cb229-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-37"><a href="#cb229-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb229-38"><a href="#cb229-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'combined_smooths.tiff'</span>),</span>
<span id="cb229-39"><a href="#cb229-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> combined_plot,</span>
<span id="cb229-40"><a href="#cb229-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">14</span>,</span>
<span id="cb229-41"><a href="#cb229-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb229-42"><a href="#cb229-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb229-43"><a href="#cb229-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb229-44"><a href="#cb229-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-45"><a href="#cb229-45" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-188-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-100"><img src="SM2_modelling_files/figure-html/unnamed-chunk-188-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="frequency-plots" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="frequency-plots"><span class="header-section-number">6.2</span> Frequency plots</h2>
<p>It may be useful to have the frequency plots for the same collection of vowels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>combined_freq_plot <span class="ot">&lt;-</span> (dress_int <span class="sc">+</span> fleece_f1_int) <span class="sc">/</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  (kit_f1_int <span class="sc">+</span> kit_f2_int)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'combined_freq.tiff'</span>),</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> combined_freq_plot,</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">14</span>,</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>combined_freq_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-189-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-101"><img src="SM2_modelling_files/figure-html/unnamed-chunk-189-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vowel-space-plots" class="level2 page-columns page-full" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="vowel-space-plots"><span class="header-section-number">6.3</span> Vowel space plots</h2>
<p>We now plot all the models in a vowel space diagram. For the paper, we restrict ourself to the span from 50 to 60 months (i.e.&nbsp;4;2 to 5). This avoids edge behaviour in the smooths.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>model_preds <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vowel, formant_type, predictions) <span class="sc">|&gt;</span> </span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(predictions)</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We widen the dataframe to get a column for F1 and for F2.</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>model_widepreds <span class="ot">&lt;-</span> model_preds <span class="sc">|&gt;</span> </span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>    gender, formant_type, vowel, </span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">.epred</span><span class="st">`</span>, <span class="st">`</span><span class="at">.epred.lower</span><span class="st">`</span>, <span class="st">`</span><span class="at">.epred.upper</span><span class="st">`</span>,</span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">.row</span><span class="st">`</span>, age</span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">'formant_type'</span>,</span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">'.epred'</span>, <span class="st">'.epred.lower'</span>, <span class="st">'.epred.upper'</span>)</span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(age, <span class="dv">50</span>, <span class="dv">60</span>)</span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the folowinmg vector to reorder the vowel vector and thus control</span></span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a><span class="co"># the order in which vowel sappear in the legend of our plots.</span></span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a>vowel_names <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FLEECE"</span>, <span class="st">"GOOSE"</span>, <span class="st">"DRESS"</span>, <span class="st">"NURSE"</span>, <span class="st">"THOUGHT"</span>, <span class="st">"KIT"</span>, <span class="st">"TRAP"</span>, <span class="st">"LOT"</span>, <span class="st">"STRUT"</span>,</span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"START"</span></span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>caregivers_label <span class="ot">&lt;-</span> <span class="st">"Caregivers' generation (F)"</span></span>
<span id="cb231-28"><a href="#cb231-28" aria-hidden="true" tabindex="-1"></a>youngest_label <span class="ot">&lt;-</span> <span class="st">"Youngest children (4;2)"</span></span>
<span id="cb231-29"><a href="#cb231-29" aria-hidden="true" tabindex="-1"></a>oldest_label <span class="ot">&lt;-</span> <span class="st">"Oldest generation (F)"</span></span>
<span id="cb231-30"><a href="#cb231-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-31"><a href="#cb231-31" aria-hidden="true" tabindex="-1"></a>first_obs <span class="ot">&lt;-</span> model_widepreds <span class="sc">|&gt;</span> </span>
<span id="cb231-32"><a href="#cb231-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, gender) <span class="sc">|&gt;</span> </span>
<span id="cb231-33"><a href="#cb231-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which.min</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb231-34"><a href="#cb231-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb231-35"><a href="#cb231-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-36"><a href="#cb231-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">if_else</span>(</span>
<span id="cb231-37"><a href="#cb231-37" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"M"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span></span>
<span id="cb231-38"><a href="#cb231-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb231-39"><a href="#cb231-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb231-40"><a href="#cb231-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-41"><a href="#cb231-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Data used to draw confidence intervals for youngest speakers.</span></span>
<span id="cb231-42"><a href="#cb231-42" aria-hidden="true" tabindex="-1"></a>grid_obs <span class="ot">&lt;-</span> first_obs <span class="sc">|&gt;</span> </span>
<span id="cb231-43"><a href="#cb231-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vowel, gender, <span class="fu">matches</span>(<span class="st">'upper|lower'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb231-44"><a href="#cb231-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb231-45"><a href="#cb231-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_min =</span> .epred.lower_F2_lob2,</span>
<span id="cb231-46"><a href="#cb231-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_max =</span> .epred.upper_F2_lob2,</span>
<span id="cb231-47"><a href="#cb231-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_min =</span> .epred.lower_F1_lob2,</span>
<span id="cb231-48"><a href="#cb231-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_max =</span> .epred.upper_F1_lob2</span>
<span id="cb231-49"><a href="#cb231-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-50"><a href="#cb231-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-51"><a href="#cb231-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="dv">1</span></span>
<span id="cb231-52"><a href="#cb231-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-53"><a href="#cb231-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vowel, gender) <span class="sc">|&gt;</span> </span>
<span id="cb231-54"><a href="#cb231-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-55"><a href="#cb231-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="fu">cumsum</span>(count),</span>
<span id="cb231-56"><a href="#cb231-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">hole =</span> border <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb231-57"><a href="#cb231-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-58"><a href="#cb231-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">|&gt;</span> </span>
<span id="cb231-59"><a href="#cb231-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb231-60"><a href="#cb231-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">'y_min|y_max'</span>),</span>
<span id="cb231-61"><a href="#cb231-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"y_type"</span>,</span>
<span id="cb231-62"><a href="#cb231-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"F1_lob2"</span></span>
<span id="cb231-63"><a href="#cb231-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-64"><a href="#cb231-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb231-65"><a href="#cb231-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">'x_min|x_max'</span>),</span>
<span id="cb231-66"><a href="#cb231-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"x_type"</span>,</span>
<span id="cb231-67"><a href="#cb231-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"F2_lob2"</span></span>
<span id="cb231-68"><a href="#cb231-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-69"><a href="#cb231-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-70"><a href="#cb231-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="fu">str_c</span>(vowel, border),</span>
<span id="cb231-71"><a href="#cb231-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">hole =</span> <span class="fu">str_c</span>(vowel, hole),</span>
<span id="cb231-72"><a href="#cb231-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sort out order in which polygon is drawn</span></span>
<span id="cb231-73"><a href="#cb231-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="fu">case_when</span>(</span>
<span id="cb231-74"><a href="#cb231-74" aria-hidden="true" tabindex="-1"></a>      y_type <span class="sc">==</span> <span class="st">"y_min"</span> <span class="sc">&amp;</span> x_type <span class="sc">==</span> <span class="st">"x_min"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb231-75"><a href="#cb231-75" aria-hidden="true" tabindex="-1"></a>      y_type <span class="sc">==</span> <span class="st">"y_min"</span> <span class="sc">&amp;</span> x_type <span class="sc">==</span> <span class="st">"x_max"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb231-76"><a href="#cb231-76" aria-hidden="true" tabindex="-1"></a>      y_type <span class="sc">==</span> <span class="st">"y_max"</span> <span class="sc">&amp;</span> x_type <span class="sc">==</span> <span class="st">"x_max"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb231-77"><a href="#cb231-77" aria-hidden="true" tabindex="-1"></a>      y_type <span class="sc">==</span> <span class="st">"y_max"</span> <span class="sc">&amp;</span> x_type <span class="sc">==</span> <span class="st">"x_min"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb231-78"><a href="#cb231-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb231-79"><a href="#cb231-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-80"><a href="#cb231-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(</span>
<span id="cb231-81"><a href="#cb231-81" aria-hidden="true" tabindex="-1"></a>    order</span>
<span id="cb231-82"><a href="#cb231-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb231-83"><a href="#cb231-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-84"><a href="#cb231-84" aria-hidden="true" tabindex="-1"></a>caregiver_obs <span class="ot">&lt;-</span> caregivers <span class="sc">|&gt;</span></span>
<span id="cb231-85"><a href="#cb231-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb231-86"><a href="#cb231-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> formant_type,</span>
<span id="cb231-87"><a href="#cb231-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> caregiver_level</span>
<span id="cb231-88"><a href="#cb231-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-89"><a href="#cb231-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-90"><a href="#cb231-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> caregivers_label,</span>
<span id="cb231-91"><a href="#cb231-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Little trick to get the values in both gender panes.</span></span>
<span id="cb231-92"><a href="#cb231-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male =</span> <span class="dv">1</span>,</span>
<span id="cb231-93"><a href="#cb231-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female =</span> <span class="dv">1</span>,</span>
<span id="cb231-94"><a href="#cb231-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-95"><a href="#cb231-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb231-96"><a href="#cb231-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>),</span>
<span id="cb231-97"><a href="#cb231-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"gender"</span>,</span>
<span id="cb231-98"><a href="#cb231-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"forget_me"</span></span>
<span id="cb231-99"><a href="#cb231-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-100"><a href="#cb231-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>forget_me)</span>
<span id="cb231-101"><a href="#cb231-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-102"><a href="#cb231-102" aria-hidden="true" tabindex="-1"></a>oldest_obs <span class="ot">&lt;-</span> oldest_generation <span class="sc">|&gt;</span></span>
<span id="cb231-103"><a href="#cb231-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb231-104"><a href="#cb231-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> formant_type,</span>
<span id="cb231-105"><a href="#cb231-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> caregiver_level</span>
<span id="cb231-106"><a href="#cb231-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-107"><a href="#cb231-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-108"><a href="#cb231-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> oldest_label,</span>
<span id="cb231-109"><a href="#cb231-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Little trick to get the values in both gender panes.</span></span>
<span id="cb231-110"><a href="#cb231-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male =</span> <span class="dv">1</span>,</span>
<span id="cb231-111"><a href="#cb231-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female =</span> <span class="dv">1</span>,</span>
<span id="cb231-112"><a href="#cb231-112" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-113"><a href="#cb231-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb231-114"><a href="#cb231-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>),</span>
<span id="cb231-115"><a href="#cb231-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"gender"</span>,</span>
<span id="cb231-116"><a href="#cb231-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"forget_me"</span></span>
<span id="cb231-117"><a href="#cb231-117" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb231-118"><a href="#cb231-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>forget_me)</span>
<span id="cb231-119"><a href="#cb231-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-120"><a href="#cb231-120" aria-hidden="true" tabindex="-1"></a>reference_points <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb231-121"><a href="#cb231-121" aria-hidden="true" tabindex="-1"></a>  first_obs <span class="sc">|&gt;</span> </span>
<span id="cb231-122"><a href="#cb231-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb231-123"><a href="#cb231-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Youngest (4;2)"</span></span>
<span id="cb231-124"><a href="#cb231-124" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb231-125"><a href="#cb231-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb231-126"><a href="#cb231-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">F1_lob2 =</span> .epred_F1_lob2,</span>
<span id="cb231-127"><a href="#cb231-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">F2_lob2 =</span> .epred_F2_lob2</span>
<span id="cb231-128"><a href="#cb231-128" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb231-129"><a href="#cb231-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb231-130"><a href="#cb231-130" aria-hidden="true" tabindex="-1"></a>      vowel, label, F1_lob2, F2_lob2, gender</span>
<span id="cb231-131"><a href="#cb231-131" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb231-132"><a href="#cb231-132" aria-hidden="true" tabindex="-1"></a>  caregiver_obs <span class="sc">|&gt;</span> </span>
<span id="cb231-133"><a href="#cb231-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb231-134"><a href="#cb231-134" aria-hidden="true" tabindex="-1"></a>      vowel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DRESS"</span>, <span class="st">"KIT"</span>, <span class="st">"TRAP"</span>, <span class="st">"FLEECE"</span>, <span class="st">"NURSE"</span>)</span>
<span id="cb231-135"><a href="#cb231-135" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb231-136"><a href="#cb231-136" aria-hidden="true" tabindex="-1"></a>  oldest_obs <span class="sc">|&gt;</span> </span>
<span id="cb231-137"><a href="#cb231-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb231-138"><a href="#cb231-138" aria-hidden="true" tabindex="-1"></a>      vowel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DRESS"</span>, <span class="st">"KIT"</span>, <span class="st">"TRAP"</span>, <span class="st">"FLEECE"</span>, <span class="st">"NURSE"</span>)</span>
<span id="cb231-139"><a href="#cb231-139" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb231-140"><a href="#cb231-140" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb231-141"><a href="#cb231-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-142"><a href="#cb231-142" aria-hidden="true" tabindex="-1"></a>out_plot <span class="ot">&lt;-</span> model_widepreds <span class="sc">|&gt;</span> </span>
<span id="cb231-143"><a href="#cb231-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-144"><a href="#cb231-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">vowel =</span> <span class="fu">factor</span>(vowel, <span class="at">levels =</span> vowel_names),</span>
<span id="cb231-145"><a href="#cb231-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">if_else</span>(gender <span class="sc">==</span> <span class="st">"M"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb231-146"><a href="#cb231-146" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb231-147"><a href="#cb231-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb231-148"><a href="#cb231-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb231-149"><a href="#cb231-149" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> .epred_F2_lob2,</span>
<span id="cb231-150"><a href="#cb231-150" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> .epred_F1_lob2,</span>
<span id="cb231-151"><a href="#cb231-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb231-152"><a href="#cb231-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> vowel,</span>
<span id="cb231-153"><a href="#cb231-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> vowel</span>
<span id="cb231-154"><a href="#cb231-154" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb231-155"><a href="#cb231-155" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb231-156"><a href="#cb231-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb231-157"><a href="#cb231-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> reference_points, </span>
<span id="cb231-158"><a href="#cb231-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb231-159"><a href="#cb231-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb231-160"><a href="#cb231-160" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2,</span>
<span id="cb231-161"><a href="#cb231-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb231-162"><a href="#cb231-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb231-163"><a href="#cb231-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> label,</span>
<span id="cb231-164"><a href="#cb231-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> label</span>
<span id="cb231-165"><a href="#cb231-165" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb231-166"><a href="#cb231-166" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show.legend = FALSE</span></span>
<span id="cb231-167"><a href="#cb231-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb231-168"><a href="#cb231-168" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb231-169"><a href="#cb231-169" aria-hidden="true" tabindex="-1"></a>  <span class="co"># path</span></span>
<span id="cb231-170"><a href="#cb231-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb231-171"><a href="#cb231-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb231-172"><a href="#cb231-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(</span>
<span id="cb231-173"><a href="#cb231-173" aria-hidden="true" tabindex="-1"></a>        <span class="at">ends =</span> <span class="st">"last"</span>, </span>
<span id="cb231-174"><a href="#cb231-174" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">"closed"</span>,</span>
<span id="cb231-175"><a href="#cb231-175" aria-hidden="true" tabindex="-1"></a>        <span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)</span>
<span id="cb231-176"><a href="#cb231-176" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb231-177"><a href="#cb231-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb231-178"><a href="#cb231-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.7</span></span>
<span id="cb231-179"><a href="#cb231-179" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb231-180"><a href="#cb231-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>), <span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb231-181"><a href="#cb231-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb231-182"><a href="#cb231-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> vowel_colours_5) <span class="sc">+</span> <span class="do">####</span></span>
<span id="cb231-183"><a href="#cb231-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb231-184"><a href="#cb231-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">list</span>(</span>
<span id="cb231-185"><a href="#cb231-185" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Caregivers' generation (F)"</span> <span class="ot">=</span> <span class="dv">18</span>,</span>
<span id="cb231-186"><a href="#cb231-186" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Youngest (4;2)"</span> <span class="ot">=</span> <span class="dv">20</span>,</span>
<span id="cb231-187"><a href="#cb231-187" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Oldest generation (F)"</span> <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb231-188"><a href="#cb231-188" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb231-189"><a href="#cb231-189" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb231-190"><a href="#cb231-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb231-191"><a href="#cb231-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"F1 (normalised)"</span>,</span>
<span id="cb231-192"><a href="#cb231-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"F2 (normalised)"</span>,</span>
<span id="cb231-193"><a href="#cb231-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Vowel"</span>,</span>
<span id="cb231-194"><a href="#cb231-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Population"</span>,</span>
<span id="cb231-195"><a href="#cb231-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="st">"Confidence</span><span class="sc">\n</span><span class="st"> (Youngest speakers)"</span></span>
<span id="cb231-196"><a href="#cb231-196" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb231-197"><a href="#cb231-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb231-198"><a href="#cb231-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb231-199"><a href="#cb231-199" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>)</span>
<span id="cb231-200"><a href="#cb231-200" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb231-201"><a href="#cb231-201" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb231-202"><a href="#cb231-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb231-203"><a href="#cb231-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(gender))</span>
<span id="cb231-204"><a href="#cb231-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-205"><a href="#cb231-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-206"><a href="#cb231-206" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb231-207"><a href="#cb231-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'nofreq_preds.tiff'</span>),</span>
<span id="cb231-208"><a href="#cb231-208" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> out_plot,</span>
<span id="cb231-209"><a href="#cb231-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb231-210"><a href="#cb231-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb231-211"><a href="#cb231-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb231-212"><a href="#cb231-212" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb231-213"><a href="#cb231-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-214"><a href="#cb231-214" aria-hidden="true" tabindex="-1"></a>out_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-190-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-102" title="Model predictions from age 4;2 to 5 with reference points from QuakeBox corpus."><img src="SM2_modelling_files/figure-html/unnamed-chunk-190-1.png" class="img-fluid figure-img" width="672" alt="Model predictions from age 4;2 to 5 with reference points from QuakeBox corpus."></a></p>
<figcaption class="margin-caption">Model predictions from age 4;2 to 5 with reference points from QuakeBox corpus.</figcaption>
</figure>
</div>
</div>
</div>
<p>We now add the storyteller to the plot, both with points for the means for each vowel and polygons for the caregivers, youngest children, and storyteller.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>storyteller_means <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'data'</span>, <span class="st">'storyteller_means.rds'</span>))</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>storyteller_means <span class="ot">&lt;-</span> storyteller_means <span class="sc">|&gt;</span> </span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vowel =</span> celex_vowel</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Storyteller (M)"</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> short_front</span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>group_paths <span class="ot">&lt;-</span> reference_points <span class="sc">|&gt;</span> </span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(storyteller_means <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="st">"Female"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FLEECE"</span>, <span class="st">"NURSE"</span>, <span class="st">"TRAP"</span>),</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">!=</span> <span class="st">"Oldest generation (F)"</span>,</span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"Female"</span></span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(vowel)</span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a>out_plot <span class="ot">&lt;-</span> model_widepreds <span class="sc">|&gt;</span> </span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">vowel =</span> <span class="fu">factor</span>(vowel, <span class="at">levels =</span> vowel_names),</span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">if_else</span>(gender <span class="sc">==</span> <span class="st">"M"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb232-28"><a href="#cb232-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb232-29"><a href="#cb232-29" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"Female"</span></span>
<span id="cb232-30"><a href="#cb232-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb232-31"><a href="#cb232-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb232-32"><a href="#cb232-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb232-33"><a href="#cb232-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> .epred_F2_lob2,</span>
<span id="cb232-34"><a href="#cb232-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> .epred_F1_lob2,</span>
<span id="cb232-35"><a href="#cb232-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb232-36"><a href="#cb232-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> vowel,</span>
<span id="cb232-37"><a href="#cb232-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> vowel</span>
<span id="cb232-38"><a href="#cb232-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb232-39"><a href="#cb232-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-40"><a href="#cb232-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb232-41"><a href="#cb232-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> reference_points <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Female"</span>), </span>
<span id="cb232-42"><a href="#cb232-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb232-43"><a href="#cb232-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb232-44"><a href="#cb232-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2,</span>
<span id="cb232-45"><a href="#cb232-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb232-46"><a href="#cb232-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> vowel,</span>
<span id="cb232-47"><a href="#cb232-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> label</span>
<span id="cb232-48"><a href="#cb232-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb232-49"><a href="#cb232-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show.legend = FALSE</span></span>
<span id="cb232-50"><a href="#cb232-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb232-51"><a href="#cb232-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-52"><a href="#cb232-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># path</span></span>
<span id="cb232-53"><a href="#cb232-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb232-54"><a href="#cb232-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb232-55"><a href="#cb232-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(</span>
<span id="cb232-56"><a href="#cb232-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">ends =</span> <span class="st">"last"</span>, </span>
<span id="cb232-57"><a href="#cb232-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">"closed"</span>,</span>
<span id="cb232-58"><a href="#cb232-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)</span>
<span id="cb232-59"><a href="#cb232-59" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb232-60"><a href="#cb232-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb232-61"><a href="#cb232-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.7</span></span>
<span id="cb232-62"><a href="#cb232-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-63"><a href="#cb232-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># storyteller</span></span>
<span id="cb232-64"><a href="#cb232-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb232-65"><a href="#cb232-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb232-66"><a href="#cb232-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2, </span>
<span id="cb232-67"><a href="#cb232-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb232-68"><a href="#cb232-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> label</span>
<span id="cb232-69"><a href="#cb232-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb232-70"><a href="#cb232-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>storyteller_means,</span>
<span id="cb232-71"><a href="#cb232-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb232-72"><a href="#cb232-72" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-73"><a href="#cb232-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb232-74"><a href="#cb232-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb232-75"><a href="#cb232-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> F2_lob2,</span>
<span id="cb232-76"><a href="#cb232-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> F1_lob2,</span>
<span id="cb232-77"><a href="#cb232-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> label,</span>
<span id="cb232-78"><a href="#cb232-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> label</span>
<span id="cb232-79"><a href="#cb232-79" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb232-80"><a href="#cb232-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb232-81"><a href="#cb232-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb232-82"><a href="#cb232-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"NA"</span>,</span>
<span id="cb232-83"><a href="#cb232-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> group_paths</span>
<span id="cb232-84"><a href="#cb232-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-85"><a href="#cb232-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>), <span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb232-86"><a href="#cb232-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb232-87"><a href="#cb232-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> vowel_colours_5) <span class="sc">+</span></span>
<span id="cb232-88"><a href="#cb232-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb232-89"><a href="#cb232-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">list</span>(</span>
<span id="cb232-90"><a href="#cb232-90" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Caregivers' generation (F)"</span> <span class="ot">=</span> <span class="dv">18</span>, </span>
<span id="cb232-91"><a href="#cb232-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Youngest (4;2)"</span> <span class="ot">=</span> <span class="dv">20</span>, </span>
<span id="cb232-92"><a href="#cb232-92" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Oldest generation (F)"</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb232-93"><a href="#cb232-93" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Storyteller (M)"</span> <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb232-94"><a href="#cb232-94" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb232-95"><a href="#cb232-95" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-96"><a href="#cb232-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb232-97"><a href="#cb232-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"F1 (normalised)"</span>,</span>
<span id="cb232-98"><a href="#cb232-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"F2 (normalised)"</span>,</span>
<span id="cb232-99"><a href="#cb232-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Vowel"</span>,</span>
<span id="cb232-100"><a href="#cb232-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Population (Points)"</span>,</span>
<span id="cb232-101"><a href="#cb232-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Population (Triangle)"</span></span>
<span id="cb232-102"><a href="#cb232-102" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-103"><a href="#cb232-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb232-104"><a href="#cb232-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb232-105"><a href="#cb232-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb232-106"><a href="#cb232-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">order =</span> <span class="dv">3</span></span>
<span id="cb232-107"><a href="#cb232-107" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb232-108"><a href="#cb232-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-109"><a href="#cb232-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb232-110"><a href="#cb232-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-111"><a href="#cb232-111" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb232-112"><a href="#cb232-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'plots'</span>, <span class="st">'nofreq_storyteller.tiff'</span>),</span>
<span id="cb232-113"><a href="#cb232-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> out_plot,</span>
<span id="cb232-114"><a href="#cb232-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb232-115"><a href="#cb232-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb232-116"><a href="#cb232-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb232-117"><a href="#cb232-117" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb232-118"><a href="#cb232-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-119"><a href="#cb232-119" aria-hidden="true" tabindex="-1"></a>out_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-191-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-103" title="Vowel space change from 47 to 63 months with predicted caregiver level."><img src="SM2_modelling_files/figure-html/unnamed-chunk-191-1.png" class="img-fluid figure-img" width="672" alt="Vowel space change from 47 to 63 months with predicted caregiver level."></a></p>
<figcaption class="margin-caption">Vowel space change from 47 to 63 months with predicted caregiver level.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="additional-tests" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Additional tests</h1>
<section id="posterior-predictive" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="posterior-predictive"><span class="header-section-number">7.1</span> Posterior predictive</h2>
<p>In what percentage of draws from out models are we higher/lower when comparing point X and point Y?</p>
<p>In the paper, we emphasise a rise in <span class="smallcaps">fleece</span> and <span class="smallcaps">dress</span> and a lowering of <span class="smallcaps">kit</span> for our female speakers and backing in <span class="smallcaps">kit</span> for the male speakers.</p>
<p>We’ll quantify our certainty about these directions of change by drawing from the posterior predictive distribution for the relevant models and testing how often the formant value at 50 months and the formant value at 60 months differ in the direction we expect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'model_name'</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dress_f1_fit_sn"</span>,</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dress_f1_fit_sn"</span>,</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fleece_f1_fit_sn"</span>,</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fleece_f1_fit_sn"</span>,</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kit_f1_fit_sn"</span>,</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kit_f1_fit_sn"</span>,</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kit_f2_fit_sn"</span></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">'sex'</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M"</span>,</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"F"</span>,</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M"</span>,</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"F"</span>,</span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M"</span>,</span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"F"</span>,</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M"</span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">direction =</span> <span class="fu">c</span>(</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rise"</span>,</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rise'</span>,</span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rise"</span>,</span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rise'</span>,</span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lower'</span>,</span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lower'</span>,</span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'back'</span></span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> directions <span class="sc">|&gt;</span> </span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">map</span>(</span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a>      model_name,</span>
<span id="cb233-35"><a href="#cb233-35" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">read_rds</span>(</span>
<span id="cb233-36"><a href="#cb233-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">here</span>(</span>
<span id="cb233-37"><a href="#cb233-37" aria-hidden="true" tabindex="-1"></a>          <span class="st">'models'</span>,</span>
<span id="cb233-38"><a href="#cb233-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste0</span>(.x, <span class="st">'.rds'</span>)</span>
<span id="cb233-39"><a href="#cb233-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb233-40"><a href="#cb233-40" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb233-41"><a href="#cb233-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb233-42"><a href="#cb233-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb233-43"><a href="#cb233-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-44"><a href="#cb233-44" aria-hidden="true" tabindex="-1"></a><span class="co"># define function to generate predictions</span></span>
<span id="cb233-45"><a href="#cb233-45" aria-hidden="true" tabindex="-1"></a>generate_predictions <span class="ot">&lt;-</span> <span class="cf">function</span>(model, sample_points, gen, <span class="at">stop =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">101</span>) {</span>
<span id="cb233-46"><a href="#cb233-46" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb233-47"><a href="#cb233-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age_s"</span> <span class="ot">=</span> sample_points,</span>
<span id="cb233-48"><a href="#cb233-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">"gender"</span> <span class="ot">=</span> gen</span>
<span id="cb233-49"><a href="#cb233-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb233-50"><a href="#cb233-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb233-51"><a href="#cb233-51" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> preds <span class="sc">|&gt;</span> </span>
<span id="cb233-52"><a href="#cb233-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb233-53"><a href="#cb233-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">stopword =</span> stop,</span>
<span id="cb233-54"><a href="#cb233-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">participant =</span> <span class="st">"bob"</span>,</span>
<span id="cb233-55"><a href="#cb233-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">collect =</span> <span class="st">"today"</span></span>
<span id="cb233-56"><a href="#cb233-56" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb233-57"><a href="#cb233-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_epred_draws</span>(</span>
<span id="cb233-58"><a href="#cb233-58" aria-hidden="true" tabindex="-1"></a>        model, </span>
<span id="cb233-59"><a href="#cb233-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">re_formula =</span> <span class="cn">NA</span>, </span>
<span id="cb233-60"><a href="#cb233-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">allow_new_levels=</span><span class="cn">TRUE</span>, </span>
<span id="cb233-61"><a href="#cb233-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">ndraws=</span><span class="dv">1000</span>,</span>
<span id="cb233-62"><a href="#cb233-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">seed =</span> seed</span>
<span id="cb233-63"><a href="#cb233-63" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb233-64"><a href="#cb233-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb233-65"><a href="#cb233-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-66"><a href="#cb233-66" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> directions <span class="sc">|&gt;</span> </span>
<span id="cb233-67"><a href="#cb233-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb233-68"><a href="#cb233-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictions =</span> <span class="fu">map2</span>(</span>
<span id="cb233-69"><a href="#cb233-69" aria-hidden="true" tabindex="-1"></a>      model, sex,</span>
<span id="cb233-70"><a href="#cb233-70" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">generate_predictions</span>(</span>
<span id="cb233-71"><a href="#cb233-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> .x, </span>
<span id="cb233-72"><a href="#cb233-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample_points =</span> <span class="fu">c</span>(</span>
<span id="cb233-73"><a href="#cb233-73" aria-hidden="true" tabindex="-1"></a>          <span class="do">## What are 50 and 60 in age_s?</span></span>
<span id="cb233-74"><a href="#cb233-74" aria-hidden="true" tabindex="-1"></a>          (<span class="dv">50</span> <span class="sc">-</span> <span class="fu">mean</span>(vowels<span class="sc">$</span>age)) <span class="sc">/</span> <span class="fu">sd</span>(vowels<span class="sc">$</span>age),</span>
<span id="cb233-75"><a href="#cb233-75" aria-hidden="true" tabindex="-1"></a>          <span class="co"># = -1.111994</span></span>
<span id="cb233-76"><a href="#cb233-76" aria-hidden="true" tabindex="-1"></a>          (<span class="dv">60</span> <span class="sc">-</span> <span class="fu">mean</span>(vowels<span class="sc">$</span>age)) <span class="sc">/</span> <span class="fu">sd</span>(vowels<span class="sc">$</span>age)</span>
<span id="cb233-77"><a href="#cb233-77" aria-hidden="true" tabindex="-1"></a>          <span class="co"># = 1.431671</span></span>
<span id="cb233-78"><a href="#cb233-78" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb233-79"><a href="#cb233-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">gen =</span> .y,</span>
<span id="cb233-80"><a href="#cb233-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">stop =</span> <span class="cn">TRUE</span></span>
<span id="cb233-81"><a href="#cb233-81" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb233-82"><a href="#cb233-82" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb233-83"><a href="#cb233-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-84"><a href="#cb233-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb233-85"><a href="#cb233-85" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span> model</span>
<span id="cb233-86"><a href="#cb233-86" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-87"><a href="#cb233-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(predictions)</span>
<span id="cb233-88"><a href="#cb233-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-89"><a href="#cb233-89" aria-hidden="true" tabindex="-1"></a>dir_table <span class="ot">&lt;-</span> directions <span class="sc">|&gt;</span> </span>
<span id="cb233-90"><a href="#cb233-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb233-91"><a href="#cb233-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">if_else</span>(</span>
<span id="cb233-92"><a href="#cb233-92" aria-hidden="true" tabindex="-1"></a>      age_s <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"age_50"</span>, <span class="st">"age_60"</span></span>
<span id="cb233-93"><a href="#cb233-93" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb233-94"><a href="#cb233-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-95"><a href="#cb233-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb233-96"><a href="#cb233-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">.draw</span><span class="st">`</span>, <span class="st">`</span><span class="at">.epred</span><span class="st">`</span>, age, gender, model_name, direction</span>
<span id="cb233-97"><a href="#cb233-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-98"><a href="#cb233-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb233-99"><a href="#cb233-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> age,</span>
<span id="cb233-100"><a href="#cb233-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">`</span><span class="at">.epred</span><span class="st">`</span></span>
<span id="cb233-101"><a href="#cb233-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-102"><a href="#cb233-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb233-103"><a href="#cb233-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">difference =</span> age_60 <span class="sc">-</span> age_50,</span>
<span id="cb233-104"><a href="#cb233-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">right_dir =</span> <span class="fu">case_when</span>(</span>
<span id="cb233-105"><a href="#cb233-105" aria-hidden="true" tabindex="-1"></a>      direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"rise"</span>, <span class="st">"back"</span>) <span class="sc">~</span> difference <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb233-106"><a href="#cb233-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> difference <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb233-107"><a href="#cb233-107" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb233-108"><a href="#cb233-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-109"><a href="#cb233-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model_name, gender) <span class="sc">|&gt;</span> </span>
<span id="cb233-110"><a href="#cb233-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb233-111"><a href="#cb233-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_50 =</span> <span class="fu">mean</span>(age_50),</span>
<span id="cb233-112"><a href="#cb233-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_60 =</span> <span class="fu">mean</span>(age_60),</span>
<span id="cb233-113"><a href="#cb233-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_diff =</span> <span class="fu">mean</span>(difference),</span>
<span id="cb233-114"><a href="#cb233-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_right =</span> <span class="fu">sum</span>(right_dir) <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb233-115"><a href="#cb233-115" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb233-116"><a href="#cb233-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb233-117"><a href="#cb233-117" aria-hidden="true" tabindex="-1"></a>    model_name, gender, perc_right</span>
<span id="cb233-118"><a href="#cb233-118" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb233-119"><a href="#cb233-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-120"><a href="#cb233-120" aria-hidden="true" tabindex="-1"></a>dir_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
# Groups:   model_name [4]
  model_name       gender perc_right
  &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt;
1 dress_f1_fit_sn  F            99.5
2 dress_f1_fit_sn  M            88  
3 fleece_f1_fit_sn F            97.5
4 fleece_f1_fit_sn M            57.4
5 kit_f1_fit_sn    F            95.6
6 kit_f1_fit_sn    M            68.1
7 kit_f2_fit_sn    M            97.4</code></pre>
</div>
</div>
</section>
<section id="longitudinal-test" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="longitudinal-test"><span class="header-section-number">7.2</span> Longitudinal test</h2>
<p>We were unable to use the longitudinal nature of the data as the centre of our modelling strategy (due to extreme patchiness in the data).</p>
<p>However, we <em>can</em> use it as a coherence check on our models. We should expect, if there is change in the direction we claim as the children age, that the mean values for a given child in subsequent recordings move in the predicted direction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We work out the difference in mean formant value between collection points.</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>collect_diffs <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span> </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant, collect, vowel) <span class="sc">|&gt;</span> </span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_F1 =</span> <span class="fu">mean</span>(F1_lob2),</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_F2 =</span> <span class="fu">mean</span>(F2_lob2),</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">first</span>(gender)</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># take only those with at least 3 tokens for the given vowel</span></span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n) <span class="sc">|&gt;</span> </span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant, vowel) <span class="sc">|&gt;</span> </span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">next_F1 =</span> <span class="fu">lead</span>(mean_F1),</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">next_F2 =</span> <span class="fu">lead</span>(mean_F2)</span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We have to remove rows with NA's (these will occur for the final collect for</span></span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># each participant, which will have NA's in the 'next_F1' and 'next_F2'</span></span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># columns)</span></span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">F1_diff =</span> next_F1 <span class="sc">-</span> mean_F1,</span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">F2_diff =</span> next_F2 <span class="sc">-</span> mean_F2</span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a>collect_diffs <span class="sc">|&gt;</span> </span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select vowels we are interested in</span></span>
<span id="cb235-29"><a href="#cb235-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb235-30"><a href="#cb235-30" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"KIT"</span>, <span class="st">"FLEECE"</span>, <span class="st">"DRESS"</span>)</span>
<span id="cb235-31"><a href="#cb235-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-32"><a href="#cb235-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb235-33"><a href="#cb235-33" aria-hidden="true" tabindex="-1"></a>    vowel, gender, F1_diff, F2_diff</span>
<span id="cb235-34"><a href="#cb235-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-35"><a href="#cb235-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb235-36"><a href="#cb235-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"F1_diff"</span>, <span class="st">"F2_diff"</span>),</span>
<span id="cb235-37"><a href="#cb235-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"formant_type"</span>,</span>
<span id="cb235-38"><a href="#cb235-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"formant_difference"</span></span>
<span id="cb235-39"><a href="#cb235-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-40"><a href="#cb235-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(</span>
<span id="cb235-41"><a href="#cb235-41" aria-hidden="true" tabindex="-1"></a>    vowel, formant_type, gender</span>
<span id="cb235-42"><a href="#cb235-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-43"><a href="#cb235-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb235-44"><a href="#cb235-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n gives the number of collection point changes so we can determine a </span></span>
<span id="cb235-45"><a href="#cb235-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># proportion</span></span>
<span id="cb235-46"><a href="#cb235-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb235-47"><a href="#cb235-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># right dir - for KIT F1, we expect an _increase_ in formant values.</span></span>
<span id="cb235-48"><a href="#cb235-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Otherwise, we expect a decrease (i.e., rising for the female children</span></span>
<span id="cb235-49"><a href="#cb235-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and backing for the male speakers)</span></span>
<span id="cb235-50"><a href="#cb235-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">right_dir =</span> <span class="fu">case_when</span>(</span>
<span id="cb235-51"><a href="#cb235-51" aria-hidden="true" tabindex="-1"></a>      formant_type <span class="sc">==</span> <span class="st">"F1_diff"</span> <span class="sc">&amp;</span> vowel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FLEECE"</span>, <span class="st">"DRESS"</span>) <span class="sc">~</span></span>
<span id="cb235-52"><a href="#cb235-52" aria-hidden="true" tabindex="-1"></a>        formant_difference <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb235-53"><a href="#cb235-53" aria-hidden="true" tabindex="-1"></a>      formant_type <span class="sc">==</span> <span class="st">"F1_diff"</span> <span class="sc">&amp;</span> vowel <span class="sc">==</span> <span class="st">"KIT"</span> <span class="sc">~</span> </span>
<span id="cb235-54"><a href="#cb235-54" aria-hidden="true" tabindex="-1"></a>        formant_difference <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb235-55"><a href="#cb235-55" aria-hidden="true" tabindex="-1"></a>      formant_type <span class="sc">==</span> <span class="st">"F2_diff"</span> <span class="sc">&amp;</span> vowel <span class="sc">==</span> <span class="st">"KIT"</span> <span class="sc">&amp;</span> gender <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span></span>
<span id="cb235-56"><a href="#cb235-56" aria-hidden="true" tabindex="-1"></a>        formant_difference <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb235-57"><a href="#cb235-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="cn">NA_real_</span></span>
<span id="cb235-58"><a href="#cb235-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb235-59"><a href="#cb235-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-60"><a href="#cb235-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb235-61"><a href="#cb235-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">formant_difference =</span> <span class="fu">first</span>(formant_difference),</span>
<span id="cb235-62"><a href="#cb235-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc =</span> <span class="fu">round</span>(<span class="fu">sum</span>(right_dir) <span class="sc">/</span> <span class="fu">first</span>(n), <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb235-63"><a href="#cb235-63" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
# Groups:   vowel, formant_type [6]
   vowel  formant_type gender formant_difference  perc
   &lt;fct&gt;  &lt;chr&gt;        &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
 1 DRESS  F1_diff      F                 -1.75    68.2
 2 DRESS  F1_diff      M                  0.386   50  
 3 DRESS  F2_diff      F                 -0.164   NA  
 4 DRESS  F2_diff      M                  0.741   NA  
 5 FLEECE F1_diff      F                 -0.682   40  
 6 FLEECE F1_diff      M                 -0.628   44  
 7 FLEECE F2_diff      F                  0.267   NA  
 8 FLEECE F2_diff      M                  2.10    NA  
 9 KIT    F1_diff      F                  0.502   56.1
10 KIT    F1_diff      M                  0.0269  54.3
11 KIT    F2_diff      F                  0.705   NA  
12 KIT    F2_diff      M                 -0.601   51.4</code></pre>
</div>
</div>
<p>We expect these values to be messy, as they can be shifted by features which are modelled for. In around 70% of cases, <span class="smallcaps">dress</span> moves in the expected direction (i.e.&nbsp;rising in the vowel space), in around 56% of times <span class="smallcaps">kit</span> moves in the expected direction for female children (i.e. lowers in the vowel space) and 50% of times for male children (i.e.&nbsp;backing in the vowel space). FLEECE moves in the expected direction in only 40% of cases (i.e.&nbsp;rising in the vowel space).</p>
</section>
</section>
<section id="non-imputed-analysis" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Non-imputed analysis</h1>
<p>We now model with the non-imputed version of Lobanov 2.0. The point of this is to get some indication that the imputation of values carried out as part of our normalisation process did not bias our results.</p>
<p>We will fit models for F1 and without word frequency and determine if they are broadly consistent with the results we have reported.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> vowels <span class="sc">|&gt;</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>F1_outlier) <span class="sc">|&gt;</span> </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>    participant, collect, age_s, gender, word, vowel, stressed, stopword, </span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>    F1_sub, log_childes_s, age</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">as.factor</span>(gender),</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">word =</span> <span class="fu">as.factor</span>(word)</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>dress_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"DRESS"</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(F1_sub)</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>dress_f1_fit_sub <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>    F1_sub <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dress_f1_data,</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb239-18"><a href="#cb239-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb239-19"><a href="#cb239-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb239-20"><a href="#cb239-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-21"><a href="#cb239-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb239-22"><a href="#cb239-22" aria-hidden="true" tabindex="-1"></a>  dress_f1_fit_sub, </span>
<span id="cb239-23"><a href="#cb239-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_fit_sub.rds'</span>), </span>
<span id="cb239-24"><a href="#cb239-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb239-25"><a href="#cb239-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>kit_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"KIT"</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(F1_sub)</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>kit_f1_fit_sub <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>  F1_sub <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> kit_f1_data,</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb241-18"><a href="#cb241-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb241-19"><a href="#cb241-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb241-20"><a href="#cb241-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-21"><a href="#cb241-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(kit_f1_fit_sub, <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f1_fit_sub.rds'</span>), <span class="at">compress =</span> <span class="st">"gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>nurse_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"NURSE"</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(F1_sub)</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are zero observations here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_data <span class="ot">&lt;-</span> f1 <span class="sc">|&gt;</span> </span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>    vowel <span class="sc">==</span> <span class="st">"FLEECE"</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(F1_sub)</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>fleece_f1_fit_sub <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>  F1_sub <span class="sc">~</span> gender <span class="sc">+</span> stopword <span class="sc">+</span> </span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(age_s, <span class="at">by=</span>gender, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> word<span class="sc">/</span>stressed) <span class="sc">+</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> participant<span class="sc">/</span>collect),</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fleece_f1_data,</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">skew_normal</span>(),</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> <span class="st">"alpha"</span>),</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>), <span class="co"># </span></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sds"</span>), <span class="co"># 0.5</span></span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>) <span class="co"># 1</span></span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">16</span>,</span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>),</span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb244-20"><a href="#cb244-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-21"><a href="#cb244-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(</span>
<span id="cb244-22"><a href="#cb244-22" aria-hidden="true" tabindex="-1"></a>  fleece_f1_fit_sub, </span>
<span id="cb244-23"><a href="#cb244-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f1_fit_sub.rds'</span>), </span>
<span id="cb244-24"><a href="#cb244-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">compress =</span> <span class="st">"gz"</span></span>
<span id="cb244-25"><a href="#cb244-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will look at the ‘comparison plots’ for these. This requires a small change to the <code>comp_plots</code> function (folded below).</p>
<div class="cell">
<details class="code-fold">
<summary>To view the code click here</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>comp_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model_preds, qb_prediction, data) {</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  mean_formant <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="fu">contains</span>(<span class="st">'_sub'</span>)) <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> model_preds <span class="sc">|&gt;</span> </span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> age,</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> .epred,</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> .epred.lower,</span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> .epred.upper,</span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> gender</span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">yintercept =</span> caregiver_level, </span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> label</span>
<span id="cb245-21"><a href="#cb245-21" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb245-22"><a href="#cb245-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> qb_prediction</span>
<span id="cb245-23"><a href="#cb245-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb245-24"><a href="#cb245-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rug</span>(</span>
<span id="cb245-25"><a href="#cb245-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb245-26"><a href="#cb245-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> age,</span>
<span id="cb245-27"><a href="#cb245-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> dummy,</span>
<span id="cb245-28"><a href="#cb245-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> gender</span>
<span id="cb245-29"><a href="#cb245-29" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb245-30"><a href="#cb245-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">sides =</span> <span class="st">"b"</span>, </span>
<span id="cb245-31"><a href="#cb245-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data <span class="sc">|&gt;</span> </span>
<span id="cb245-32"><a href="#cb245-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb245-33"><a href="#cb245-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">dummy =</span> <span class="fu">seq</span>(</span>
<span id="cb245-34"><a href="#cb245-34" aria-hidden="true" tabindex="-1"></a>            mean_formant <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb245-35"><a href="#cb245-35" aria-hidden="true" tabindex="-1"></a>            mean_formant <span class="sc">+</span> <span class="fl">0.1</span>, </span>
<span id="cb245-36"><a href="#cb245-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">length.out =</span> <span class="fu">nrow</span>(data)</span>
<span id="cb245-37"><a href="#cb245-37" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb245-38"><a href="#cb245-38" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb245-39"><a href="#cb245-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">inherit.aes=</span><span class="cn">FALSE</span>, </span>
<span id="cb245-40"><a href="#cb245-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">position=</span><span class="st">"jitter"</span></span>
<span id="cb245-41"><a href="#cb245-41" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb245-42"><a href="#cb245-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb245-43"><a href="#cb245-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb245-44"><a href="#cb245-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Model predictions QB1 vs Kids"</span>,</span>
<span id="cb245-45"><a href="#cb245-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Age (months)"</span>,</span>
<span id="cb245-46"><a href="#cb245-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Normalised formant value (predicted)"</span>,</span>
<span id="cb245-47"><a href="#cb245-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">"Gender"</span>,</span>
<span id="cb245-48"><a href="#cb245-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"Reference"</span></span>
<span id="cb245-49"><a href="#cb245-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb245-50"><a href="#cb245-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>dress_f1_fit_sub <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'dress_f1_fit_sub.rds'</span>))</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>fleece_f1_fit_sub <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'fleece_f1_fit_sub.rds'</span>))</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>kit_f1_fit_sub <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">'models'</span>, <span class="st">'kit_f1_fit_sub.rds'</span>))</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>comp_plots <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vowel =</span> <span class="fu">c</span>(<span class="st">"DRESS"</span>, <span class="st">"FLEECE"</span>, <span class="st">"KIT"</span>),</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">formant_type =</span> <span class="st">"F1_lob2"</span>,</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">list</span>(</span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>      dress_f1_data,</span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a>      fleece_f1_data,</span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a>      kit_f1_data</span>
<span id="cb246-12"><a href="#cb246-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb246-13"><a href="#cb246-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">list</span>(</span>
<span id="cb246-14"><a href="#cb246-14" aria-hidden="true" tabindex="-1"></a>    dress_f1_fit_sub,</span>
<span id="cb246-15"><a href="#cb246-15" aria-hidden="true" tabindex="-1"></a>    fleece_f1_fit_sub,</span>
<span id="cb246-16"><a href="#cb246-16" aria-hidden="true" tabindex="-1"></a>    kit_f1_fit_sub</span>
<span id="cb246-17"><a href="#cb246-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb246-18"><a href="#cb246-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb246-19"><a href="#cb246-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-20"><a href="#cb246-20" aria-hidden="true" tabindex="-1"></a>comp_plots <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span> </span>
<span id="cb246-21"><a href="#cb246-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb246-22"><a href="#cb246-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictions =</span> <span class="fu">map2</span>(data, model, smooth_preds)</span>
<span id="cb246-23"><a href="#cb246-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb246-24"><a href="#cb246-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-25"><a href="#cb246-25" aria-hidden="true" tabindex="-1"></a><span class="fu">comp_plot</span>(comp_plots<span class="sc">$</span>predictions[[<span class="dv">1</span>]], caregivers, comp_plots<span class="sc">$</span>data[[<span class="dv">1</span>]])</span>
<span id="cb246-26"><a href="#cb246-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-27"><a href="#cb246-27" aria-hidden="true" tabindex="-1"></a>comp_plots <span class="ot">&lt;-</span> comp_plots <span class="sc">|&gt;</span></span>
<span id="cb246-28"><a href="#cb246-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb246-29"><a href="#cb246-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="fu">pmap</span>(</span>
<span id="cb246-30"><a href="#cb246-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(vowel, formant_type, predictions, data),</span>
<span id="cb246-31"><a href="#cb246-31" aria-hidden="true" tabindex="-1"></a>      \(x, y, z, dat) {</span>
<span id="cb246-32"><a href="#cb246-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">comp_plot</span>(</span>
<span id="cb246-33"><a href="#cb246-33" aria-hidden="true" tabindex="-1"></a>          z <span class="sc">|&gt;</span> </span>
<span id="cb246-34"><a href="#cb246-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(</span>
<span id="cb246-35"><a href="#cb246-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">between</span>(age, <span class="dv">47</span>, <span class="dv">62</span>)</span>
<span id="cb246-36"><a href="#cb246-36" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb246-37"><a href="#cb246-37" aria-hidden="true" tabindex="-1"></a>          caregivers <span class="sc">|&gt;</span> </span>
<span id="cb246-38"><a href="#cb246-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(</span>
<span id="cb246-39"><a href="#cb246-39" aria-hidden="true" tabindex="-1"></a>              vowel <span class="sc">==</span> x,</span>
<span id="cb246-40"><a href="#cb246-40" aria-hidden="true" tabindex="-1"></a>              formant_type <span class="sc">==</span> y</span>
<span id="cb246-41"><a href="#cb246-41" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb246-42"><a href="#cb246-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> dat</span>
<span id="cb246-43"><a href="#cb246-43" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb246-44"><a href="#cb246-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(</span>
<span id="cb246-45"><a href="#cb246-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="fu">paste0</span>(x, <span class="st">" "</span>, y)</span>
<span id="cb246-46"><a href="#cb246-46" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb246-47"><a href="#cb246-47" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb246-48"><a href="#cb246-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb246-49"><a href="#cb246-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>  comp_plots<span class="sc">$</span>plot,</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-204-1.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-204-1.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-204-2.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-204-2.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="SM2_modelling_files/figure-html/unnamed-chunk-204-3.png" class="lightbox" data-gallery="comp-plots"><img src="SM2_modelling_files/figure-html/unnamed-chunk-204-3.png" class="img-fluid" width="672"></a></p>
</div>
</div>
</div>
<p>These models are consistent with the previous ones for <span class="smallcaps">dress</span> and <span class="smallcaps">kit</span>, and consistent with the general <em>extremity</em> of <span class="smallcaps">fleece</span>, but not the apparent rise of <span class="smallcaps">fleece</span> over time in the vowel space.</p>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div class="cell">
<div class="cell-output-display">

</div>
</div>
<div class="refs">

</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-rmarkdown2024" class="csl-entry" role="listitem">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier Luraschi, Kevin Ushey, Aron Atkins, et al. 2024. <em><span class="nocase">rmarkdown</span>: Dynamic Documents for r</em>. <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-fasttrackr" class="csl-entry" role="listitem">
Barreda, Santiago, and Joey Stanley. 2024. <em><span class="nocase">fasttrackr</span>: Fast Track Integration in r</em>. <a href="https://github.com/santiagobarreda/FastTrackR">https://github.com/santiagobarreda/FastTrackR</a>.
</div>
<div id="ref-imager" class="csl-entry" role="listitem">
Barthelme, Simon. 2024. <em><span class="nocase">imager</span>: Image Processing Library Based on <span>‘<span>CImg</span>’</span></em>. <a href="https://CRAN.R-project.org/package=imager">https://CRAN.R-project.org/package=imager</a>.
</div>
<div id="ref-rPraat" class="csl-entry" role="listitem">
Bořil, Tomáš, and Radek Skarnitzl. 2016. <span>‘Tools rPraat and mPraat’</span>. In <em>Text, Speech, and Dialogue: 19th International Conference, TSD 2016, Brno, Czech Republic, September 12-16, 2016, Proceedings</em>, edited by Petr Sojka, Aleš Horák, Ivan Kopeček, and Karel Pala, 367–74. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-45510-5_42">https://doi.org/10.1007/978-3-319-45510-5_42</a>.
</div>
<div id="ref-brms2017" class="csl-entry" role="listitem">
Bürkner, Paul-Christian. 2017. <span>‘<span class="nocase">brms</span>: An <span>R</span> Package for <span>Bayesian</span> Multilevel Models Using <span>Stan</span>’</span>. <em>Journal of Statistical Software</em> 80 (1): 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>.
</div>
<div id="ref-brms2018" class="csl-entry" role="listitem">
———. 2018. <span>‘Advanced <span>Bayesian</span> Multilevel Modeling with the <span>R</span> Package <span class="nocase">brms</span>’</span>. <em>The R Journal</em> 10 (1): 395–411. <a href="https://doi.org/10.32614/RJ-2018-017">https://doi.org/10.32614/RJ-2018-017</a>.
</div>
<div id="ref-brms2021" class="csl-entry" role="listitem">
———. 2021. <span>‘Bayesian Item Response Modeling in <span>R</span> with <span class="nocase">brms</span> and <span>Stan</span>’</span>. <em>Journal of Statistical Software</em> 100 (5): 1–54. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>.
</div>
<div id="ref-secr" class="csl-entry" role="listitem">
Efford, Murray. 2024. <em><span class="nocase">secr</span>: Spatially Explicit Capture-Recapture Models</em>. <a href="https://CRAN.R-project.org/package=secr">https://CRAN.R-project.org/package=secr</a>.
</div>
<div id="ref-nzilbblabbcat" class="csl-entry" role="listitem">
Fromont, Robert. 2023. <em><span class="nocase">nzilbb.labbcat</span>: Accessing Data Stored in <span>‘<span>LaBB-CAT</span>’</span> Instances</em>. <a href="https://CRAN.R-project.org/package=nzilbb.labbcat">https://CRAN.R-project.org/package=nzilbb.labbcat</a>.
</div>
<div id="ref-bayesplot2024" class="csl-entry" role="listitem">
Gabry, Jonah, and Tristan Mahr. 2024. <span>‘<span class="nocase">bayesplot</span>: Plotting for Bayesian Models’</span>. <a href="https://mc-stan.org/bayesplot/">https://mc-stan.org/bayesplot/</a>.
</div>
<div id="ref-bayesplot2019" class="csl-entry" role="listitem">
Gabry, Jonah, Daniel Simpson, Aki Vehtari, Michael Betancourt, and Andrew Gelman. 2019. <span>‘Visualization in Bayesian Workflow’</span>. <em>J. R. Stat. Soc. A</em> 182: 389–402. <a href="https://doi.org/10.1111/rssa.12378">https://doi.org/10.1111/rssa.12378</a>.
</div>
<div id="ref-glue" class="csl-entry" role="listitem">
Hester, Jim, and Jennifer Bryan. 2024. <em><span class="nocase">glue</span>: Interpreted String Literals</em>. <a href="https://CRAN.R-project.org/package=glue">https://CRAN.R-project.org/package=glue</a>.
</div>
<div id="ref-DiagrammeR" class="csl-entry" role="listitem">
Iannone, Richard, and Olivier Roy. 2024. <em><span>DiagrammeR</span>: Graph/Network Visualization</em>. <a href="https://CRAN.R-project.org/package=DiagrammeR">https://CRAN.R-project.org/package=DiagrammeR</a>.
</div>
<div id="ref-ggcorrplot" class="csl-entry" role="listitem">
Kassambara, Alboukadel. 2023. <em><span class="nocase">ggcorrplot</span>: Visualization of a Correlation Matrix Using <span>‘<span class="nocase">ggplot2</span>’</span></em>. <a href="https://CRAN.R-project.org/package=ggcorrplot">https://CRAN.R-project.org/package=ggcorrplot</a>.
</div>
<div id="ref-tidybayes" class="csl-entry" role="listitem">
Kay, Matthew. 2023. <em><span class="nocase">tidybayes</span>: Tidy Data and Geoms for <span>Bayesian</span> Models</em>. <a href="https://doi.org/10.5281/zenodo.1308151">https://doi.org/10.5281/zenodo.1308151</a>.
</div>
<div id="ref-ggdist2024b" class="csl-entry" role="listitem">
———. 2024a. <em><span class="nocase">ggdist</span>: Visualizations of Distributions and Uncertainty</em>. <a href="https://doi.org/10.5281/zenodo.3879620">https://doi.org/10.5281/zenodo.3879620</a>.
</div>
<div id="ref-ggdist2024a" class="csl-entry" role="listitem">
———. 2024b. <span>‘<span class="nocase">ggdist</span>: Visualizations of Distributions and Uncertainty in the Grammar of Graphics’</span>. <em>IEEE Transactions on Visualization and Computer Graphics</em> 30 (1): 414–24. <a href="https://doi.org/10.1109/TVCG.2023.3327195">https://doi.org/10.1109/TVCG.2023.3327195</a>.
</div>
<div id="ref-here" class="csl-entry" role="listitem">
Müller, Kirill. 2020. <em><span class="nocase">here</span>: A Simpler Way to Find Your Files</em>. <a href="https://CRAN.R-project.org/package=here">https://CRAN.R-project.org/package=here</a>.
</div>
<div id="ref-ggforce" class="csl-entry" role="listitem">
Pedersen, Thomas Lin. 2024. <em><span class="nocase">ggforce</span>: Accelerating <span>‘<span class="nocase">ggplot2</span>’</span></em>. <a href="https://CRAN.R-project.org/package=ggforce">https://CRAN.R-project.org/package=ggforce</a>.
</div>
<div id="ref-scico" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, and Fabio Crameri. 2023. <em><span class="nocase">scico</span>: Colour Palettes Based on the Scientific Colour-Maps</em>. <a href="https://CRAN.R-project.org/package=scico">https://CRAN.R-project.org/package=scico</a>.
</div>
<div id="ref-base" class="csl-entry" role="listitem">
R Core Team. 2024. <em><span>R</span>: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-ggrepel" class="csl-entry" role="listitem">
Slowikowski, Kamil. 2024. <em><span class="nocase">ggrepel</span>: Automatically Position Non-Overlapping Text Labels with <span>‘<span class="nocase">ggplot2</span>’</span></em>. <a href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</a>.
</div>
<div id="ref-itsadug" class="csl-entry" role="listitem">
van Rij, Jacolien, Martijn Wieling, R. Harald Baayen, and Hedderik van Rijn. 2022. <span>‘<span class="nocase">itsadug</span>: Interpreting Time Series and Autocorrelated Data Using GAMMs’</span>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>‘Welcome to the <span class="nocase">tidyverse</span>’</span>. <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-nzilbbvowels" class="csl-entry" role="listitem">
Wilson Black, Joshua, and James Brand. 2024. <em><span class="nocase">nzilbb.vowels</span>: Functions and Data for Vowel Covariation Studies</em>. <a href="https://github.com/JoshuaWilsonBlack/nzilbb_vowels">https://github.com/JoshuaWilsonBlack/nzilbb_vowels</a>.
</div>
<div id="ref-mgcv2017" class="csl-entry" role="listitem">
Wood, S. N. 2017. <em>Generalized Additive Models: An Introduction with r</em>. 2nd ed. Chapman; Hall/CRC.
</div>
<div id="ref-mgcv2003" class="csl-entry" role="listitem">
Wood, S. N. 2003. <span>‘Thin-Plate Regression Splines’</span>. <em>Journal of the Royal Statistical Society (B)</em> 65 (1): 95–114.
</div>
<div id="ref-mgcv2004" class="csl-entry" role="listitem">
———. 2004. <span>‘Stable and Efficient Multiple Smoothing Parameter Estimation for Generalized Additive Models’</span>. <em>Journal of the American Statistical Association</em> 99 (467): 673–86.
</div>
<div id="ref-mgcv2011" class="csl-entry" role="listitem">
———. 2011. <span>‘Fast Stable Restricted Maximum Likelihood and Marginal Likelihood Estimation of Semiparametric Generalized Linear Models’</span>. <em>Journal of the Royal Statistical Society (B)</em> 73 (1): 3–36.
</div>
<div id="ref-mgcv2016" class="csl-entry" role="listitem">
Wood, S. N., N., Pya, and B. S"afken. 2016. <span>‘Smoothing Parameter and Model Selection for General Smooth Models (with Discussion)’</span>. <em>Journal of the American Statistical Association</em> 111: 1548–75.
</div>
<div id="ref-knitr2014" class="csl-entry" role="listitem">
Xie, Yihui. 2014. <span>‘<span class="nocase">knitr</span>: A Comprehensive Tool for Reproducible Research in <span>R</span>’</span>. In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC.
</div>
<div id="ref-knitr2015" class="csl-entry" role="listitem">
———. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-knitr2024" class="csl-entry" role="listitem">
———. 2024. <em><span class="nocase">knitr</span>: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-rmarkdown2018" class="csl-entry" role="listitem">
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. <em>R Markdown: The Definitive Guide</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-rmarkdown2020" class="csl-entry" role="listitem">
Xie, Yihui, Christophe Dervieux, and Emily Riederer. 2020. <em>R Markdown Cookbook</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>.
</div>
<div id="ref-kableExtra" class="csl-entry" role="listitem">
Zhu, Hao. 2024. <em><span class="nocase">kableExtra</span>: Construct Complex Table with <span>‘<span class="nocase">kable</span>’</span> and Pipe Syntax</em>. <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>